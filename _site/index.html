<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Hyde &middot; A Jekyll theme
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Hyde
        </a>
      </h1>
      <p class="lead">A brazen two-column <a href="http://jekyllrb.com" target="_blank">Jekyll</a> theme that pairs a prominent sidebar with uncomplicated content. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item active" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/poole/hyde/archive/v2.1.0.zip">Download</a>
      <a class="sidebar-nav-item" href="https://github.com/poole/hyde">GitHub project</a>
      <span class="sidebar-nav-item">Currently v2.1.0</span>
    </nav>

    <p>&copy; 2018. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2018/07/12/Recursion-Demystified-99a2105cb871/">
        Recursion Demystified
      </a>
    </h1>

    <span class="post-date">12 Jul 2018</span>
  
    
    <!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Recursion Demystified</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 40px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<section data-field="subtitle" class="p-summary">
In order to understand recursion, you must first understand recursion.
</section>
<section data-field="body" class="e-content">
<section name="e3cf" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3511" id="3511" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="1b59" id="1b59" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36.4%;"></div><img class="graf-image" data-image-id="1*yNNmaPaMjbto_oSlcO7hvQ.png" data-width="2960" data-height="1076" src="https://cdn-images-1.medium.com/max/2000/1*yNNmaPaMjbto_oSlcO7hvQ.png"></div><figcaption class="imageCaption">Source: <a href="https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png" data-href="https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><blockquote name="bc1c" id="bc1c" class="graf graf--pullquote graf-after--figure">In order to understand recursion, you must first understand recursion.</blockquote><p name="245f" id="245f" class="graf graf--p graf-after--pullquote">Crazy, isn’t it ?
    <br>
    <a href="/2018/07/12/Recursion-Demystified-99a2105cb871/">
         Read More...
    </a>
    <hr>
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Recursion Demystified</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 40px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<section data-field="subtitle" class="p-summary">
In order to understand recursion, you must first understand recursion.
</section>
<section data-field="body" class="e-content">
<section name="e3cf" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3511" id="3511" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="1b59" id="1b59" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36.4%;"></div><img class="graf-image" data-image-id="1*yNNmaPaMjbto_oSlcO7hvQ.png" data-width="2960" data-height="1076" src="https://cdn-images-1.medium.com/max/2000/1*yNNmaPaMjbto_oSlcO7hvQ.png"></div><figcaption class="imageCaption">Source: <a href="https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png" data-href="https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><blockquote name="bc1c" id="bc1c" class="graf graf--pullquote graf-after--figure">In order to understand recursion, you must first understand recursion.</blockquote><p name="245f" id="245f" class="graf graf--p graf-after--pullquote">Crazy, isn’t it ?  <p name="2f41" id="2f41" class="graf graf--p graf-after--p">Well, I hope that by the end of this article you will feel much more confident about what recursion is and mainly, how we can come up with a recursive solution to a problem.-->
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Recursion Demystified</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 40px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<section data-field="subtitle" class="p-summary">
In order to understand recursion, you must first understand recursion.
</section>
<section data-field="body" class="e-content">
<section name="e3cf" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3511" id="3511" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="1b59" id="1b59" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36.4%;"></div><img class="graf-image" data-image-id="1*yNNmaPaMjbto_oSlcO7hvQ.png" data-width="2960" data-height="1076" src="https://cdn-images-1.medium.com/max/2000/1*yNNmaPaMjbto_oSlcO7hvQ.png"></div><figcaption class="imageCaption">Source: <a href="https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png" data-href="https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://thomaspark.co/wp/wp-content/uploads/2017/01/xkcd.png</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><blockquote name="bc1c" id="bc1c" class="graf graf--pullquote graf-after--figure">In order to understand recursion, you must first understand recursion.</blockquote><p name="245f" id="245f" class="graf graf--p graf-after--pullquote">Crazy, isn’t it ?</p><p name="2f41" id="2f41" class="graf graf--p graf-after--p">Well, I hope that by the end of this article you will feel much more confident about what recursion is and mainly, how we can come up with a recursive solution to a problem.</p><h3 name="1488" id="1488" class="graf graf--h3 graf-after--p">What is Recursion?</h3><p name="7aa6" id="7aa6" class="graf graf--p graf-after--h3">How do you explain recursion to a 4 year old? This is a pretty famous interview question, and there are loads of answers available on the web. We won’t answer this question as it is too mainstream.</p><p name="4947" id="4947" class="graf graf--p graf-after--p">If you are as clever as I am 🤓🤓, you would explain recursion to someone one year younger than you. Have them explain recursion to someone one year younger than them. Continue until you have a 5 year old explaining recursion to a 4 year old. Done. [Source: <a href="https://www.reddit.com/r/programmerchat/comments/3ua9ie/how_would_you_explain_recursion_to_a_6_year_old/" data-href="https://www.reddit.com/r/programmerchat/comments/3ua9ie/how_would_you_explain_recursion_to_a_6_year_old/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">reddit</a>].</p><figure name="0bb3" id="0bb3" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://giphy.com/embed/gsYKROakiJQPu/twitter/iframe" width="435" height="244" frameborder="0" scrolling="no"></iframe><figcaption class="imageCaption"><a href="https://giphy.com/gifs/reaction-gsYKROakiJQPu" data-href="https://giphy.com/gifs/reaction-gsYKROakiJQPu" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://giphy.com/gifs/reaction-gsYKROakiJQPu</a></figcaption></figure><p name="68d6" id="68d6" class="graf graf--p graf-after--figure">In programming terms, recursion is</p><blockquote name="f352" id="f352" class="graf graf--pullquote graf-after--p">A function calling itself.</blockquote><figure name="23fb" id="23fb" class="graf graf--figure graf--iframe graf-after--pullquote"><script src="https://gist.github.com/edorado93/e37127955dee6041a864337d1297a153.js"></script></figure><p name="6e6b" id="6e6b" class="graf graf--p graf-after--figure">The above function does no useful work as such, but it does demonstrate recursion. The recursive relation above would be</p><pre name="bb9c" id="bb9c" class="graf graf--pre graf-after--p">T(N) = T(N - 1) + O(1)</pre><p name="d18b" id="d18b" class="graf graf--p graf-after--pre">This simply means that the execution for the call to <code class="markup--code markup--p-code">random_function(n)</code> cannot proceed until the call to <code class="markup--code markup--p-code">random_function(n-1)</code> is completed and so on.</p><p name="1df0" id="1df0" class="graf graf--p graf-after--p">Essentially, we delay the execution of the current state of the function until another call to the same function has completed and returned it’s result.</p><p name="f6d5" id="f6d5" class="graf graf--p graf-after--p">The compiler keeps on saving the state of the function call now and then moves onto the next function call and so on. So, the compiler saves function states onto a stack and uses that for computations and backtracking.</p><figure name="38a6" id="38a6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 707px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 101%;"></div><img class="graf-image" data-image-id="1*UkdvcDN_JPxLvB62pTTj2g.png" data-width="1420" data-height="1434" src="https://cdn-images-1.medium.com/max/800/1*UkdvcDN_JPxLvB62pTTj2g.png"></div><figcaption class="imageCaption">Recursion stack of a set of function calls.</figcaption></figure><p name="4433" id="4433" class="graf graf--p graf-after--figure">Essentially, if a problem can be broken down into similar subproblems which can be solved individually, and whose solutions can be combined together to get the overall solution, then we say that there might exist a recursive solution to the problem.</p><p name="d044" id="d044" class="graf graf--p graf-after--p">Instead of clinging to this seemingly old definition of recursion, we will look at a whole bunch of applications of recursion. Then hopefully things will be clear.</p><h3 name="0141" id="0141" class="graf graf--h3 graf-after--p">Factorial of a Number</h3><p name="d917" id="d917" class="graf graf--p graf-after--h3">Let us see how we can find out the factorial of a number. Before that, let’s see what the factorial of a number represents and how it is calculated.</p><pre name="de25" id="de25" class="graf graf--pre graf-after--p">factorial(N) = 1 * 2 * 3 * .... * N - 1 * N</pre><p name="a120" id="a120" class="graf graf--p graf-after--pre">Simply put, the factorial of a number is just the product of terms from 1 to the number N multiplied by one another.</p><p name="5147" id="5147" class="graf graf--p graf-after--p">We can simply have a <code class="markup--code markup--p-code">for</code> loop from 1 to N and multiply all the terms iteratively and we will have the factorial of the given number.</p><p name="0046" id="0046" class="graf graf--p graf-after--p">But, if you look closely, there exists an inherent recursive structure to the factorial of a number.</p><pre name="cfe6" id="cfe6" class="graf graf--pre graf-after--p">factorial(N) = N * factorial(N - 1)</pre><p name="6035" id="6035" class="graf graf--p graf-after--pre">It’s like offloading the computation to another function call operating on a smaller version of the original problem. Let’s see how this relation would unfold to verify if the solution here matches the one provided by the <code class="markup--code markup--p-code">for</code> loop.</p><figure name="22c2" id="22c2" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 583px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 83.3%;"></div><img class="graf-image" data-image-id="1*k6ThFBJ1_Wm1i-Wqu10HFw.png" data-width="1404" data-height="1170" src="https://cdn-images-1.medium.com/max/800/1*k6ThFBJ1_Wm1i-Wqu10HFw.png"></div><figcaption class="imageCaption">Showing the steps from top to bottom for the factorial recursive function</figcaption></figure><figure name="9214" id="9214" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 679px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 97%;"></div><img class="graf-image" data-image-id="1*dDy6r1_y-a0ey-hY8KbT_Q.png" data-width="1400" data-height="1358" src="https://cdn-images-1.medium.com/max/800/1*dDy6r1_y-a0ey-hY8KbT_Q.png"></div><figcaption class="imageCaption">Verification that the recursive function defined produces the correct result</figcaption></figure><p name="b072" id="b072" class="graf graf--p graf-after--figure">So, it is clear from the two figures above that the recursive function that we defined earlier,</p><pre name="187c" id="187c" class="graf graf--pre graf-after--p">factorial(N) = N * factorial(N - 1)</pre><p name="f314" id="f314" class="graf graf--p graf-after--pre">is indeed correct. Have a look at the Python code snippet used to find the factorial of a function, recursively.</p><figure name="c48a" id="c48a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/a87fa4fe17c0c8ee3815b7859a0cd13c.js"></script></figure><p name="9b78" id="9b78" class="graf graf--p graf-after--figure">This example was pretty simple. Let us consider a slightly bigger but standard example to demonstrate the concept of recursion.</p><h3 name="7a65" id="7a65" class="graf graf--h3 graf-after--p">Fibonacci Sequence</h3><p name="3a15" id="3a15" class="graf graf--p graf-after--h3">You must be already familiar with the famous fibonacci sequence. For those of you who have’t heard about this sequence or seen an example before, lets have a look.</p><pre name="8f1b" id="8f1b" class="graf graf--pre graf-after--p">1 1  2   3     5           8                       13 ..... </pre><p name="af07" id="af07" class="graf graf--p graf-after--pre">Let us look at the formula for calculating the n^th fibonacci number.</p><pre name="b698" id="b698" class="graf graf--pre graf-after--p">F(n) = F(n - 1) + F(n - 2)<br>where F(1) = F(2) = 1</pre><p name="cc0c" id="cc0c" class="graf graf--p graf-after--pre">Clearly, this definition of the fibonacci sequence is recursive in nature, since the n^th fibonacci number is dependent upon the previous two fibonacci numbers. This means dividing the problem into smaller subproblems, and hence recursion. Have a look at the code for this:</p><figure name="582b" id="582b" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/62631e1b7e4081c677db31dbfd141732.js"></script></figure><p name="0013" id="0013" class="graf graf--p graf-after--figure">Every recursive problem must have two necessary things:</p><ol class="postList"><li name="328f" id="328f" class="graf graf--li graf-after--p">The recurrence relation defining the states of the problem and how the main problem can be broken down into smaller subproblems. This also includes the base case for stopping the recursion.</li><li name="13d1" id="13d1" class="graf graf--li graf-after--li">A recursion tree that showcases the first few, if not all calls to the function under consideration. Have a look at the recursion tree for the fibonacci sequences’ recursive relation.</li></ol><figure name="ca81" id="ca81" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 749px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 106.89999999999999%;"></div><img class="graf-image" data-image-id="1*2VfyZniOm8hK7w6NYq7Phw.png" data-width="1210" data-height="1294" src="https://cdn-images-1.medium.com/max/800/1*2VfyZniOm8hK7w6NYq7Phw.png"></div><figcaption class="imageCaption">Recursion tree showing the sequence of calls for the fibonacci recurrence relation.</figcaption></figure><p name="d257" id="d257" class="graf graf--p graf-after--figure">The recursion tree shows us that the results obtained from processing the two subtrees of the root N can be used to compute the result for the tree rooted at N. Similarly for other nodes.</p><p name="1b20" id="1b20" class="graf graf--p graf-after--p">The leaves of this recursion tree would be <code class="markup--code markup--p-code">fibonacci(1)</code> or <code class="markup--code markup--p-code">fibonacci(2)</code> both of which represent the base cases for this recursion.</p><p name="3f0a" id="3f0a" class="graf graf--p graf-after--p">Now that we have a very basic grasp of recursion, what a recurrence relation is, and the recursion tree, let’s move onto something more interesting.</p><p name="a5c2" id="a5c2" class="graf graf--p graf-after--p">Examples!</p><p name="3a6b" id="3a6b" class="graf graf--p graf-after--p">I strongly believe in solving umpteen number of examples for any given topic in programming to become a master of that topic. The two examples we considered (Factorial of a number and the Fibonacci sequence) had well defined recurrence relations. Let us look at a few examples where the recurrence relation might not be so obvious.</p><h3 name="5422" id="5422" class="graf graf--h3 graf-after--p">Height of a Tree</h3><p name="2dd6" id="2dd6" class="graf graf--p graf-after--h3">To keep things simple for this example, we will only consider a binary tree. So, a binary tree is a tree data structure in which each node has at most two children. One node of the tree is designated as the root of the tree, for example:</p><figure name="e00e" id="e00e" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 853px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 121.8%;"></div><img class="graf-image" data-image-id="1*XAVkpjgzPOGiEsKVgvBd9A.png" data-width="1266" data-height="1542" src="https://cdn-images-1.medium.com/max/800/1*XAVkpjgzPOGiEsKVgvBd9A.png"></div><figcaption class="imageCaption">A Tree rooted at ‘A’ with its height and the corresponding path highlighted.</figcaption></figure><p name="dc81" id="dc81" class="graf graf--p graf-after--figure">Let’s define what we mean by the height of the binary tree.</p><blockquote name="6c50" id="6c50" class="graf graf--pullquote graf-after--p">Height of the tree would be the length of the longest root to leaf path in the tree.</blockquote><p name="48a9" id="48a9" class="graf graf--p graf-after--pullquote">So, for the example diagram displayed above, considering that the node labelled as <code class="markup--code markup--p-code">A</code> as the root of the tree, the longest root to leaf path is <code class="markup--code markup--p-code">A → C → E → G → I </code>. Essentially, the height of this tree is <code class="markup--code markup--p-code">5</code> if we count the number of nodes and <code class="markup--code markup--p-code">4</code> if we just count the number of edges on the longest path.</p><p name="a47e" id="a47e" class="graf graf--p graf-after--p">Now, forget about the entire tree and just focus on the portions highlighted in the diagram below.</p><figure name="45ab" id="45ab" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 574px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 82.1%;"></div><img class="graf-image" data-image-id="1*h0454CLOXfyvp_u02F4-fQ.png" data-width="1372" data-height="1126" src="https://cdn-images-1.medium.com/max/800/1*h0454CLOXfyvp_u02F4-fQ.png"></div><figcaption class="imageCaption">Tree rooted at node A and it’s two subtrees with their respective heights.</figcaption></figure><p name="cf72" id="cf72" class="graf graf--p graf-after--figure">The above figure shows us that we can represent a tree in the form of its subtrees. Essentially, the structure to the left of node A and the structure to the right of A is also a binary tree in itself, just smaller and with different root nodes. But, they are binary trees nonetheless.</p><p name="f67a" id="f67a" class="graf graf--p graf-after--p">What information can we get from these two subtrees that would help us find the height of the main tree rooted at A ?</p><p name="65cb" id="65cb" class="graf graf--p graf-after--p">If we knew the height of the left subtree, say <code class="markup--code markup--p-code">h1</code>, and the height of the right subtree, say <code class="markup--code markup--p-code">h2</code>, then we can simply say that the <code class="markup--code markup--p-code">maximum of the two + 1</code> for the node A would give us the height of our tree. Isn’t that right?</p><p name="63f1" id="63f1" class="graf graf--p graf-after--p">Formalizing this recursive relation,</p><pre name="3102" id="3102" class="graf graf--pre graf-after--p">height(root) = max(height(root.left), height(root.right)) + 1</pre><p name="4a7f" id="4a7f" class="graf graf--p graf-after--pre">So, that’s the recursive definition of the height of a <strong class="markup--strong markup--p-strong">binary</strong> tree. The focus is on binary here, because we used just two children of the node <code class="markup--code markup--p-code">root </code>represented by <code class="markup--code markup--p-code">root.left </code>and <code class="markup--code markup--p-code">root.right.</code> But, it is easy to extend this recursive relation to an n-ary tree. Let’s take a look at this in code.</p><figure name="b738" id="b738" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/87de419cc4c84cb7c48a7c44b2c8ebf0.js"></script></figure><p name="9b9a" id="9b9a" class="graf graf--p graf-after--figure">The problem here was greatly simplified because we let recursion do all the heavy lifting for us. We simply used <strong class="markup--strong markup--p-strong">optimal<em class="markup--em markup--p-em"> </em></strong>answers for our subproblems to find a solution to our original problem.</p><p name="b8a4" id="b8a4" class="graf graf--p graf-after--p">Let’s look at another example that can be solved on similar lines.</p><h3 name="b460" id="b460" class="graf graf--h3 graf-after--p">Number of Nodes in a Tree</h3><p name="2780" id="2780" class="graf graf--p graf-after--h3">Here again, we will consider a binary tree for simplicity, but the algorithm and the approach can be extended to any kind of tree essentially.</p><p name="2880" id="2880" class="graf graf--p graf-after--p">The problem is itself very self explanatory. Given the root of a binary tree, we need to determine the total number of nodes in the tree. This question and the approach we will come up with here are very similar to the previous one. We just have to make minuscule changes and we will have the number of nodes in the binary tree.</p><p name="8384" id="8384" class="graf graf--p graf-after--p">Take a look at the diagram below.</p><figure name="cdca" id="cdca" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 583px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 83.3%;"></div><img class="graf-image" data-image-id="1*Fu_K_bkWs5ECzVwFnuakhA.png" data-width="1316" data-height="1096" src="https://cdn-images-1.medium.com/max/800/1*Fu_K_bkWs5ECzVwFnuakhA.png"></div></figure><p name="1984" id="1984" class="graf graf--p graf-after--figure">The diagram says it all. We already know that a tree can be broken down into smaller subtrees. Here again, we can ask ourselves,</p><blockquote name="f68d" id="f68d" class="graf graf--pullquote graf-after--p">What information can we get from these two subtrees that would help us find the number of nodes in the tree rooted at A?</blockquote><p name="2d15" id="2d15" class="graf graf--p graf-after--pullquote">Well, if we knew the number of nodes in the left subtree and the number of nodes in the right subtree, we can simply add them up and add one for the root node and that would give us the total number of nodes.</p><p name="a41b" id="a41b" class="graf graf--p graf-after--p">Formalizing this we get,</p><pre name="78c8" id="78c8" class="graf graf--pre graf-after--p">number_of_nodes(root) = number_of_nodes(root.left) + number_of_nodes(right) + 1</pre><p name="c64c" id="c64c" class="graf graf--p graf-after--pre">If you look at this recursion and the previous one, you will find that they are extremely similar. The only thing that is varying is what we do with the information we obtained from our subproblems and how we combined them to get some answer.</p><figure name="a155" id="a155" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/97cfaa0d09e9139c0710dae50c895b2e.js"></script></figure><p name="3621" id="3621" class="graf graf--p graf-after--figure">Now that we have seen a couple of easy examples with a binary tree, let’s move onto something less trivial.</p><h3 name="5044" id="5044" class="graf graf--h3 graf-after--p">Merge Sort</h3><p name="cd2c" id="cd2c" class="graf graf--p graf-after--h3">Given an array of numbers like</p><pre name="5a70" id="5a70" class="graf graf--pre graf-after--p">4 2 8 9 1 5 2</pre><p name="50ac" id="50ac" class="graf graf--p graf-after--pre">we need to come up with a sorting technique that sorts them either in ascending or descending order. There are a lot of famous sorting techniques out there for this like <a href="https://en.wikipedia.org/wiki/Quicksort" data-href="https://en.wikipedia.org/wiki/Quicksort" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Quick Sort</a>, <a href="https://en.wikipedia.org/wiki/Heapsort" data-href="https://en.wikipedia.org/wiki/Heapsort" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Heap Sort</a>, <a href="https://en.wikipedia.org/wiki/Radix_sort" data-href="https://en.wikipedia.org/wiki/Radix_sort" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Radix Sort</a> and so on. But we are specifically going to look at a technique called the Merge Sort.</p><p name="d755" id="d755" class="graf graf--p graf-after--p">It’s possible that a lot of you are familiar with the <a href="https://en.wikipedia.org/wiki/Divide_and_conquer_algorithm" data-href="https://en.wikipedia.org/wiki/Divide_and_conquer_algorithm" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Divide and Conquer paradigm</a>, and this might feel redundant. But bear with me and read on!</p><p name="e4c7" id="e4c7" class="graf graf--p graf-after--p">The idea here is to break it down into subproblems.</p><figure name="0c05" id="0c05" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://giphy.com/embed/26gsaLkUSO6uNiXsc/twitter/iframe" width="435" height="277" frameborder="0" scrolling="no"></iframe><figcaption class="imageCaption"><a href="https://giphy.com/gifs/latelateshow-clapping-james-corden-26gsaLkUSO6uNiXsc" data-href="https://giphy.com/gifs/latelateshow-clapping-james-corden-26gsaLkUSO6uNiXsc" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://giphy.com/gifs/latelateshow-clapping-james-corden-26gsaLkUSO6uNiXsc</a></figcaption></figure><p name="1d23" id="1d23" class="graf graf--p graf-after--figure">That’s what the article is about right ? 😛</p><p name="0865" id="0865" class="graf graf--p graf-after--p">What if we had two sorted halves of the original array. Can we use them somehow to sort the entire array?</p><p name="1162" id="1162" class="graf graf--p graf-after--p">That’s the main idea here. The task of sorting an array can be broken down into two smaller subtasks:</p><ul class="postList"><li name="8e83" id="8e83" class="graf graf--li graf-after--p">sorting two different halves of the array</li><li name="12a4" id="12a4" class="graf graf--li graf-after--li">then using those sorted halves to obtain the original sorted array</li></ul><p name="6bc6" id="6bc6" class="graf graf--p graf-after--li">Now, the beauty about recursion is, you don’t need to worry about how we will get two sorted halves and what logic will go into that. Since this is recursion, the same method call to <code class="markup--code markup--p-code">merge_sort</code> would sort the two halves for us. All we need to do is focus on what we need to do once we have the sorted haves with us.</p><p name="34f4" id="34f4" class="graf graf--p graf-after--p">Let’s go through the code:</p><figure name="6567" id="6567" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/35a3f34c1c13e736d717eb92c4c7073e.js"></script></figure><p name="6686" id="6686" class="graf graf--p graf-after--figure">At this point, we trusted and relied on our good friend recursion and assumed that <code class="markup--code markup--p-code">left_sorted_half</code> and <code class="markup--code markup--p-code">right_sorted_half</code> would in fact contain the two sorted halves of the original array.</p><p name="7a39" id="7a39" class="graf graf--p graf-after--p">So, what next?</p><p name="4e24" id="4e24" class="graf graf--p graf-after--p">The question is how to combine them somehow to give the entire array.</p><p name="b06c" id="b06c" class="graf graf--p graf-after--p">The problem now simply boils down to merging two sorted arrays into one. This is a pretty standard problem and can be solved by what is known as the “two finger approach”.</p><p name="2fe8" id="2fe8" class="graf graf--p graf-after--p">Take a look at the pseudo code for better understanding.</p><pre name="ed8a" id="ed8a" class="graf graf--pre graf-after--p">let L and R be our two sorted halves. <br>let ans be the combined, sorted array <br>l = 0 // The pointer for the left half<br>r = 0 // The pointer for the right half<br>a = 0 // The pointer for the array ans <br>while l &lt; L.length and r &lt; R.length {<br>      if L[l] &lt; R[r] {<br>           ans[a] = L[l]<br>           l++<br>       } else {<br>           ans[a] = R[r]<br>           r++<br>      }<br>} <br>copy remaining array portion of L or R, whichever was longer, into ans.</pre><p name="0eb6" id="0eb6" class="graf graf--p graf-after--pre">Here we have two pointers (fingers), and we position them at the start of the individual halves. We check which one is smaller (that is, which value pointed at by the finger is smaller), and we add that value to our sorted combined array. We then advance the respective pointer (finger) forward. In the end we copy the remaining portion of the longer array and add it to the back of the <code class="markup--code markup--p-code">ans</code> array.</p><p name="6a90" id="6a90" class="graf graf--p graf-after--p">So, the combined code for merge-sort is as follows:</p><figure name="36ad" id="36ad" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/2ddf8ef17df8c6d1b54d2d6973cbacec.js"></script></figure><p name="a8f7" id="a8f7" class="graf graf--p graf-after--figure">We will do one final question using recursion and trust me, it’s a tough one and a pretty confusing one. But before moving onto that, I will iterate the steps I follow whenever I have to think of a recursive solution to a problem.</p><h3 name="5225" id="5225" class="graf graf--h3 graf-after--p">Steps to come up with a Recursive Solution</h3><ol class="postList"><li name="33cf" id="33cf" class="graf graf--li graf-after--h3">Try and break down the problem into subproblems.</li></ol><figure name="9acd" id="9acd" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 600px; max-height: 399px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.5%;"></div><img class="graf-image" data-image-id="1*aak-cm8casUG2vyVhlBVIw.png" data-width="600" data-height="399" src="https://cdn-images-1.medium.com/max/800/1*aak-cm8casUG2vyVhlBVIw.png"></div><figcaption class="imageCaption">Source: <a href="https://www.weheartswift.com/compute-2-power-n/" data-href="https://www.weheartswift.com/compute-2-power-n/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.weheartswift.com/compute-2-power-n/</a></figcaption></figure><p name="082a" id="082a" class="graf graf--p graf-after--figure">2. Once you have the subproblems figured out, think about what information from the call to the subproblems can you use to solve the task at hand. For example, the factorial of <code class="markup--code markup--p-code">N — 1</code> to find the factorial of <code class="markup--code markup--p-code">N</code> , height of the left and right subtrees to find the height of the main tree, and so on.</p><figure name="f19e" id="f19e" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 671px; max-height: 588px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 87.6%;"></div><img class="graf-image" data-image-id="1*deig5GtZ71owj63KcdEJcg.png" data-width="671" data-height="588" src="https://cdn-images-1.medium.com/max/800/1*deig5GtZ71owj63KcdEJcg.png"></div></figure><p name="72e4" id="72e4" class="graf graf--p graf-after--figure">3. Keep calm and trust recursion! Assume that your recursive calls to the subproblems will return the information you need in the most optimal fashion.</p><figure name="7534" id="7534" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 525px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><img class="graf-image" data-image-id="1*ViEEM9XNagm79MAW5GR2mw.png" data-width="1600" data-height="1200" src="https://cdn-images-1.medium.com/max/800/1*ViEEM9XNagm79MAW5GR2mw.png"></div><figcaption class="imageCaption">Source: <a href="https://neildanson.files.wordpress.com/2014/02/keep-calm-it-just-works.png" data-href="https://neildanson.files.wordpress.com/2014/02/keep-calm-it-just-works.png" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://neildanson.files.wordpress.com/2014/02/keep-calm-it-just-works.png</a></figcaption></figure><p name="8d2c" id="8d2c" class="graf graf--p graf-after--figure">4. The final step in this process is actually using information we just got from the subproblems to find the solution to the main problem. Once you have that, you’re ready to code up your recursive solution.</p><p name="b715" id="b715" class="graf graf--p graf-after--p">Now that we have all the steps lined up, let’s move on to our final problem in this article. It’s called <a href="https://leetcode.com/problems/sum-of-distances-in-tree/description/" data-href="https://leetcode.com/problems/sum-of-distances-in-tree/description/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Sum of Distances in a Tree.</a></p><h3 name="792e" id="792e" class="graf graf--h3 graf-after--p">Sum of Distances in a Tree</h3><p name="3ae9" id="3ae9" class="graf graf--p graf-after--h3">Let’s look at what the question is asking us to do here. Consider the following tree.</p><figure name="563b" id="563b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 714px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 102%;"></div><img class="graf-image" data-image-id="1*U3An6J_vH3b2Ej0SO_XpUw.png" data-width="1328" data-height="1354" src="https://cdn-images-1.medium.com/max/800/1*U3An6J_vH3b2Ej0SO_XpUw.png"></div><figcaption class="imageCaption">Example tree showing the expected output of our program for the various nodes.</figcaption></figure><p name="2639" id="2639" class="graf graf--p graf-after--figure">In the example above, the sum of paths for the node A (the number of nodes on <strong class="markup--strong markup--p-strong">each path</strong> from <code class="markup--code markup--p-code">A</code> to every other vertex in the tree) is 9. The individual paths are mentioned in the diagram itself with their respective lengths.</p><p name="ca6d" id="ca6d" class="graf graf--p graf-after--p">Similarly, consider the sum of distances for the node C.</p><pre name="5291" id="5291" class="graf graf--pre graf-after--p">C --&gt; A --&gt; B (Length 2)<br>C --&gt; A (Length 1)<br>C --&gt; D (Length 1)<br>C --&gt; E (Length 1)<br>C --&gt; D --&gt; F (Length 2)<br>Sum of distances (C) = 2 + 1 + 1 + 1 + 2 = 7</pre><p name="1065" id="1065" class="graf graf--p graf-after--pre">This is known as the sum of distances as defined for just a single node A or C. We need to calculate these distances for each of the nodes in the tree.</p><p name="65cc" id="65cc" class="graf graf--p graf-after--p">Before actually solving this generic problem, let us consider a simplified version of the same problem. It says that we just need to calculate the sum of distances for a given node, but we will only consider the tree rooted at the given node for calculations.</p><p name="5752" id="5752" class="graf graf--p graf-after--p">So, for the node C, this simplified version of the problem would ask us to calculate:</p><pre name="71e3" id="71e3" class="graf graf--pre graf-after--p">C --&gt; D (Length 1)<br>C --&gt; E (Length 1)<br>C --&gt; D --&gt; F (Length 2)<br>Simplified Sum of Distances (C) = 1 + 1 + 2 = 4</pre><p name="2705" id="2705" class="graf graf--p graf-after--pre">This is a much simpler problem to tackle recursively and would prove to be useful in solving the original problem.</p><p name="8ac3" id="8ac3" class="graf graf--p graf-after--p">Consider the following simple tree.</p><figure name="e268" id="e268" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 779px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 111.3%;"></div><img class="graf-image" data-image-id="1*bomBBwkaLxNXqUGno7rD6Q.png" data-width="1346" data-height="1498" src="https://cdn-images-1.medium.com/max/800/1*bomBBwkaLxNXqUGno7rD6Q.png"></div><figcaption class="imageCaption">The simple tree we would consider for now. Also mentioned are two values we would be computing for every node.</figcaption></figure><p name="1a21" id="1a21" class="graf graf--p graf-after--figure">The nodes B and C are the children of the root (that is, A).</p><p name="408b" id="408b" class="graf graf--p graf-after--p">We are trying to see what information can we use from subproblems (the children) to compute the answer for the root <code class="markup--code markup--p-code">A</code> .</p><p name="cedf" id="cedf" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Note</strong>: here we simply want to calculate the sum of paths for a given node X to all its successors in its own subtree (the tree rooted at the node X).</p><p name="9843" id="9843" class="graf graf--p graf-after--p">There are no downwards going paths from the node B, and so the sum of paths is 0 for the node <code class="markup--code markup--p-code">B</code> in this tree. Let’s look at the node <code class="markup--code markup--p-code">C</code> . So this node has 3 different successors in <code class="markup--code markup--p-code">F, D and E</code> . The sum of distances are as follows:</p><pre name="2cbf" id="2cbf" class="graf graf--pre graf-after--p">C --&gt; D (Path containing just 1 edge, hence sum of distances = 1)<br>C --&gt; D --&gt; F (Path containing 2 edges, hence sum of distances = 2)<br>C --&gt; E (Path containing just 1 edge, hence sum of distances = 1)</pre><p name="dbf4" id="dbf4" class="graf graf--p graf-after--pre">The sum of all the paths from the node <code class="markup--code markup--p-code">C</code> to all of its decedents is 4, and number of such paths going down is 3.</p><p name="259c" id="259c" class="graf graf--p graf-after--p">Note the difference here. The <code class="markup--code markup--p-code">sum_of_distances</code> here counts the number of edges in each path — with each edge repeating multiple times, probably because of their occurrence on different paths — unlike <code class="markup--code markup--p-code">number_of_paths</code> , which counts, well, the number of paths 😝.</p><p name="735a" id="735a" class="graf graf--p graf-after--p">If you look closely, you will realize that the number of paths going down is always going to be the number of nodes in the tree we are considering (except the root). So, for the tree rooted at C, we have 3 paths, one for the node D, one for E, and one for F. This means that the number of paths from a given node to the successor nodes is simply the total number of descendent nodes since this is a tree. So, no cycles or multiple edges.</p><p name="58b0" id="58b0" class="graf graf--p graf-after--p">Now, consider the node A. Let us look at all the new paths that are being introduced because of this node A. Forget the node B for now and just focus on the child node C corresponding to A. The new sets of paths that we have are:</p><pre name="98cd" id="98cd" class="graf graf--pre graf-after--p">A --&gt; C (Path containing just 1 edge, hence sum of distances = 1)<br>A --&gt; (C --&gt; D)    (Path containing 2 edges, hence sum of distances = 2)<br>A --&gt; (C --&gt; E)    (Path containing 2 edges, hence sum of distances = 2)<br>A --&gt; (C --&gt; D --&gt; F) (Path containing 3 edges, hence sum of distances = 3)</pre><p name="eee0" id="eee0" class="graf graf--p graf-after--pre">Except for the first path <code class="markup--code markup--p-code">A → C</code>, all the others are the same as the ones for the node C, except that we have simply changed all of them and incorporated one extra node <code class="markup--code markup--p-code">A</code>.</p><figure name="c559" id="c559" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 535px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76.4%;"></div><img class="graf-image" data-image-id="1*Q4kSg7rwJMxc4Ca17YdzBw.png" data-width="1452" data-height="1110" src="https://cdn-images-1.medium.com/max/800/1*Q4kSg7rwJMxc4Ca17YdzBw.png"></div><figcaption class="imageCaption">Sum of distances for the node A along with contribution from the node C.</figcaption></figure><p name="7020" id="7020" class="graf graf--p graf-after--figure">If you look at the diagram above you will see a tuple of values next to each of the nodes A, B, and C.</p><pre name="39f6" id="39f6" class="graf graf--pre graf-after--p">(X, Y) where <br>X is the number of paths originating at that node and going down to the decedents. <br>Y is the sum of distances for the tree rooted at the given node. </pre><p name="0aba" id="0aba" class="graf graf--p graf-after--pre">Since the node B doesn’t have any further children, the only path it is contributing to is the path <code class="markup--code markup--p-code">A --&gt; B</code> to <code class="markup--code markup--p-code">A&#39;s</code> tuple of (5, 9) above. So let’s talk about C.</p><p name="442a" id="442a" class="graf graf--p graf-after--p">C had three paths going to its successors. Those three paths (extended by one more node for A) also become three paths from A to its successors, among others.</p><pre name="ad6b" id="ad6b" class="graf graf--pre graf-after--p">N-Paths[A] = (N-Paths[C] + 1) + (N-Paths[B] + 1)</pre><p name="7e6e" id="7e6e" class="graf graf--p graf-after--pre">That is the exact relation we are looking for as far as the number of paths (= number of successor nodes in the tree) are concerned. The 1 is because of the new path from the root to it’s child, that is <code class="markup--code markup--p-code">A --&gt; C</code> in our case.</p><pre name="9ffa" id="9ffa" class="graf graf--pre graf-after--p">N-Paths[A] = 3 + 1 + 0 + 1 = 5</pre><p name="a0ef" id="a0ef" class="graf graf--p graf-after--pre">As far as the sum of distances is concerned, take a look at the diagram and the equations we just wrote. The following formula becomes very clear:</p><pre name="d180" id="d180" class="graf graf--pre graf-after--p">Sum-Dist[A] = (N-Paths[C] + 1 + Sum-Dist[C]) + (N-Paths[B] + 1 + Sum-Dist[B]) Sum-Dist[A] = (3 + 1 + 4 + 0 + 1 + 0) = 9</pre><p name="3d9e" id="3d9e" class="graf graf--p graf-after--pre">The main thing here is <code class="markup--code markup--p-code">N-Paths[C] + Sum-Dist[C]</code> . We sum these up because all of the paths from C to its descendants ultimately become the paths from A to its descendants — except that they originate at A and go through C, and so each of the path lengths are increased by 1. There are <code class="markup--code markup--p-code">N-Paths[C]</code> paths in all originating from C and their total length is given by <code class="markup--code markup--p-code">Sum-Dist[C]</code> .</p><p name="9101" id="9101" class="graf graf--p graf-after--p">Hence the tuple corresponding to A = (5, 9). The Python code for the algorithm we discussed above is as follows:</p><figure name="7f39" id="7f39" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/f89850fc7353c7662fac133ebd49c793.js"></script></figure><h4 name="3e82" id="3e82" class="graf graf--h4 graf-after--figure">The Curious Case of the Visited Dictionary :/</h4><p name="45ac" id="45ac" class="graf graf--p graf-after--h4">If you look at the code above closely, you’ll see this:</p><pre name="7481" id="7481" class="graf graf--pre graf-after--p"># Prevents the recursion from going into a cycle.        self.visited[vertex] = 1</pre><p name="2aef" id="2aef" class="graf graf--p graf-after--pre">The comment says that this <code class="markup--code markup--p-code">visited</code> dictionary is for preventing the recursion from entering a cycle.</p><p name="3fea" id="3fea" class="graf graf--p graf-after--p">If you’ve paid attention til now, you know that we are dealing with a <code class="markup--code markup--p-code">tree</code> here.</p><p name="827a" id="827a" class="graf graf--p graf-after--p">The definition of a tree data structure doesn’t allow cycles to exist. If a cycle exists in the structure, then it is no longer a tree, it becomes a graph. In a tree, there is exactly one path between any two pair of vertices. A cycle would mean there is more than one path between a pair of vertices. Look at the figures below.</p><figure name="b477" id="b477" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 479px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.4%;"></div><img class="graf-image" data-image-id="1*vtO_LgKcmR19kzmCgSrSYw.png" data-width="2144" data-height="1466" src="https://cdn-images-1.medium.com/max/800/1*vtO_LgKcmR19kzmCgSrSYw.png"></div><figcaption class="imageCaption">Tree vs Graph. Showing the cycle.</figcaption></figure><p name="52e3" id="52e3" class="graf graf--p graf-after--figure">The structure on the left is a tree. It has no cycles in it. There is a unique path between any two vertices.</p><p name="9fae" id="9fae" class="graf graf--p graf-after--p">The structure on the right is a graph, there exists a cycle in the graph and hence there are multiple paths between any pair of vertices. For this graph, it so happens that any pair of vertices have more than one path. This is not necessary for every graph.</p><p name="aaf2" id="aaf2" class="graf graf--p graf-after--p">Almost always, we are given the <code class="markup--code markup--p-code">root</code> node of the tree. We can use the root node to traverse the entire tree <strong class="markup--strong markup--p-strong">without having to worry about any cycles as such<em class="markup--em markup--p-em">.</em></strong></p><p name="148b" id="148b" class="graf graf--p graf-after--p">However, if you’ve read the problem statement clearly, it does not state anything about root of the tree.</p><p name="229a" id="229a" class="graf graf--p graf-after--p">That means that there is no designated root for the tree given in the question. This could mean that a given tree can be visualized and processed in so many different ways depending upon what we consider as the root. Have a look at multiple structures for the same tree but with different root nodes.</p><figure name="3ae8" id="3ae8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 625px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 89.3%;"></div><img class="graf-image" data-image-id="1*DR9CZIanW-su89jiCPDtVg.png" data-width="1416" data-height="1264" src="https://cdn-images-1.medium.com/max/800/1*DR9CZIanW-su89jiCPDtVg.png"></div><figcaption class="imageCaption">Multiple orientations of the same tree with different roots.</figcaption></figure><p name="1a8f" id="1a8f" class="graf graf--p graf-after--figure">So many different interpretations and parent child relationships are possible for a given <strong class="markup--strong markup--p-strong">unrooted tree<em class="markup--em markup--p-em">.</em></strong></p><p name="4cf3" id="4cf3" class="graf graf--p graf-after--p">So, we start with the node <code class="markup--code markup--p-code">0</code> and do a DFS traversal of the given structure. In the process we fix the parent child relationships. Given the edges in the problem, we construct an undirected graph-like structure which we convert to the tree structure. Taking a look at the code should clear up some of your doubts:</p><figure name="5a68" id="5a68" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/ecbea2efcb9a3c87249e4444f35e68fb.js"></script></figure><p name="362c" id="362c" class="graf graf--p graf-after--figure">Every node would have one parent. The root won’t have any parent, and the way this logic is, the node <code class="markup--code markup--p-code">0</code> would become the root of our tree. Note that we are not doing this process separately and then calculating the <code class="markup--code markup--p-code">sum of distances downwards</code>. Given a tree, we were trying to find, for every node, the simplified sum of distances for the tree rooted at that node.</p><p name="792d" id="792d" class="graf graf--p graf-after--p">So, the conversion from the graph to the tree happens in one single iteration along with finding out the sum of distances downwards for each and every node.</p><figure name="aff1" id="aff1" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/f89850fc7353c7662fac133ebd49c793.js"></script></figure><p name="4eb9" id="4eb9" class="graf graf--p graf-after--figure">I posted the code again so that the <code class="markup--code markup--p-code">visited</code> dictionary makes much more sense now. So, one single recursion doing all that for us. Nice!</p><h4 name="1765" id="1765" class="graf graf--h4 graf-after--p">Bringing it all together</h4><p name="d0b6" id="d0b6" class="graf graf--p graf-after--h4">Now that we have our tree structure defined, and also the values of <code class="markup--code markup--p-code">sum of distances going downward</code> defined for us, we can use all of this information to solve the original problem of <a href="https://leetcode.com/problems/sum-of-distances-in-tree/description/" data-href="https://leetcode.com/problems/sum-of-distances-in-tree/description/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Sum of Distances in a Tree.</a></p><p name="81b6" id="81b6" class="graf graf--p graf-after--p">How do we do that? It’s best to explain this algorithm with the help of an example. So we will consider the tree below and we will dry run the algorithm for a single node. Let’s have a look at the tree we will be considering.</p><figure name="8b78" id="8b78" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 687px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 98.1%;"></div><img class="graf-image" data-image-id="1*_X74YieQAGUCmZvBXwIgWQ.png" data-width="1270" data-height="1246" src="https://cdn-images-1.medium.com/max/800/1*_X74YieQAGUCmZvBXwIgWQ.png"></div><figcaption class="imageCaption">The tree we will be considering for our explanation moving on.</figcaption></figure><p name="97b1" id="97b1" class="graf graf--p graf-after--figure">The node for which we want to find the sum of distances is <code class="markup--code markup--p-code">4</code>. Now, if you remember the simpler problem we were trying to solve earlier, you know that we already have two values associated with each of the nodes:</p><ol class="postList"><li name="2d60" id="2d60" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">distances_down</code> Which is the sum of distances for this node <strong class="markup--strong markup--li-strong">while only considering the tree beneath<em class="markup--em markup--li-em">.</em></strong></li><li name="2250" id="2250" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">number_of_paths_down</code> which is the number of paths / nodes in the tree rooted at the node under consideration.</li></ol><p name="a414" id="a414" class="graf graf--p graf-after--li">Let’s look at the annotated version of the above tree. The tree is annotated with tuples <code class="markup--code markup--p-code">(distances_down, number_of_paths_down)</code> .</p><figure name="6b05" id="6b05" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 653px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 93.30000000000001%;"></div><img class="graf-image" data-image-id="1*8O6xTkG84fkHB3og3rXtzA.png" data-width="1496" data-height="1396" src="https://cdn-images-1.medium.com/max/800/1*8O6xTkG84fkHB3og3rXtzA.png"></div><figcaption class="imageCaption">Example tree with annotated values for all nodes.</figcaption></figure><p name="4f15" id="4f15" class="graf graf--p graf-after--figure">Let’s call the value we want to compute for each node as <code class="markup--code markup--p-code">sod</code> which means sum of distances, which is what the question originally asks us to compute.</p><p name="7d92" id="7d92" class="graf graf--p graf-after--p">Let us assume that we have already computed the answer for the parent node of <code class="markup--code markup--p-code">4</code> in the diagram above. So, we now have the following information for the node labelled <code class="markup--code markup--p-code">2</code> (the parent node) available:</p><p name="ead4" id="ead4" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">(sod, distances_down, number_of_paths_down)</code> = <code class="markup--code markup--p-code">(13, 4, 3)</code></p><p name="59b7" id="59b7" class="graf graf--p graf-after--p">Let’s rotate the given tree and visualize it in a way where <code class="markup--code markup--p-code">2</code> is the root of the tree essentially.</p><figure name="9f2b" id="9f2b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 566px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 80.80000000000001%;"></div><img class="graf-image" data-image-id="1*TmKowuiShc8NCwxP-9VvOg.png" data-width="1500" data-height="1212" src="https://cdn-images-1.medium.com/max/800/1*TmKowuiShc8NCwxP-9VvOg.png"></div><figcaption class="imageCaption">Rotated tree showing the tree rooted at 4 should be removed.</figcaption></figure><p name="1f96" id="1f96" class="graf graf--p graf-after--figure">Now, we want to remove the contribution of the tree rooted at <code class="markup--code markup--p-code">4</code> from <code class="markup--code markup--p-code">sod(2)</code>. Let us consider all of the paths from the parent node <code class="markup--code markup--p-code">2</code> to all other nodes except the ones in the tree rooted at <code class="markup--code markup--p-code">4</code> .</p><pre name="f5f8" id="f5f8" class="graf graf--pre graf-after--p">2 --&gt; 5 (1 edge)<br>2 --&gt; 1 (1 edge)<br>2 --&gt; 1 --&gt;7 (2 edges)<br>2 --&gt; 1 --&gt; 7 --&gt; 9 (3 edges)<br>2 --&gt; 1 --&gt; 7 --&gt; 10 (3 edges) <br> Number of nodes considered = 6<br>Sum of paths remaining i.e. sod(2) rem = 1 + 1 + 2 + 3 + 3 = 10</pre><p name="9144" id="9144" class="graf graf--p graf-after--pre">Let’s see how we can use the values we already have calculated to get these updated values.</p><pre name="d045" id="d045" class="graf graf--pre graf-after--p">* N = 8 (Total number of nodes in the tree. This will remain the same for every node.)<br><br>* sod(2) = 13 <br><br>* distances_down[4] = 1<br><br>* number_of_paths_down[4] = 1 <br><br>* (distances_down[4] does not include the node 4 itself) <br><br>N - 1 - distances_down[4] = 8 - 1 - 1 = 6 <br><br>* sod(2) - 1 - distances_down[4] - number_of_paths_down[4] = 13 - 1 - 1 - 1 = 10</pre><p name="37f4" id="37f4" class="graf graf--p graf-after--pre">If you remember this from the function we defined earlier, you will notice that the contribution of a <code class="markup--code markup--p-code">child</code> node to the two values <code class="markup--code markup--p-code">distances_down and number_of_paths_down</code> is <code class="markup--code markup--p-code">n_paths + 1</code> and <code class="markup--code markup--p-code">n_paths + s_paths + 1</code> respectively. Naturally, that is what we subtract to obtain the remaining tree.</p><figure name="a4a3" id="a4a3" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/b7076f6f2cda42a672c8c8e75531e0d0.js"></script></figure><p name="831a" id="831a" class="graf graf--p graf-after--figure"><code class="markup--code markup--p-code">sod(4)</code> represents the sum of edges on all the paths originating at the node <code class="markup--code markup--p-code">4</code> in the tree above. Let’s see how we can find this out using the information we have calculated till now.</p><p name="8c22" id="8c22" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">distances_down[4]</code> represents the answer for the tree rooted at the node <code class="markup--code markup--p-code">4</code> but it only considers paths going to its successors, that is all the nodes in the tree rooted at <code class="markup--code markup--p-code">4</code>. For our example, the successor of <code class="markup--code markup--p-code">4</code> is the node <code class="markup--code markup--p-code">6</code>. So, that will directly add to the final answer. Let’s call this value <code class="markup--code markup--p-code">own_answer</code> . Now, let’s account for all the other paths.</p><pre name="0cb0" id="0cb0" class="graf graf--pre graf-after--p">4 --&gt; 2 (1 edge)<br>4 --&gt; 2 --&gt; 5 (1 + 1 edge)<br>4 --&gt; 2 --&gt; 1 (1 + 1 edge)<br>4 --&gt; 2 --&gt; 1 --&gt;7 (1 + 2 edges)<br>4 --&gt; 2 --&gt; 1 --&gt; 7 --&gt; 9 (1 + 3 edges)<br>4 --&gt; 2 --&gt; 1 --&gt; 7 --&gt; 10 (1 + 3 edges)<br>own_answer = 1 <br><br>sod(4) = 1 + 1 + 2 + 2 + 3 + 4 + 4 = 17 <br><br>sod(4) = own_answer + (N - 1 - <code class="markup--code markup--pre-code">distances_down[4]) + (</code>sod(2) - 1 - <code class="markup--code markup--pre-code">distances_down[4] - number_of_paths_down[4]) = 1 + 6 + 10 = 17</code></pre><figure name="bb11" id="bb11" class="graf graf--figure graf--iframe graf-after--pre"><iframe src="https://giphy.com/embed/FX1ZGci9qPM3u/twitter/iframe" width="435" height="568" frameborder="0" scrolling="no"></iframe><figcaption class="imageCaption">Source: <a href="https://giphy.com/gifs/angry-confused-love-life-FX1ZGci9qPM3u" data-href="https://giphy.com/gifs/angry-confused-love-life-FX1ZGci9qPM3u" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://giphy.com/gifs/angry-confused-love-life-FX1ZGci9qPM3u</a></figcaption></figure><p name="fdc6" id="fdc6" class="graf graf--p graf-after--figure">Before you go bonkers and start doing this, let’s look at the code and bring together all of the things we discussed in the example above.</p><figure name="3627" id="3627" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/99d8fcffc5fbdd7957e488096ddfd59b.js"></script></figure><p name="c0ef" id="c0ef" class="graf graf--p graf-after--figure">The recursive relation for this portion is as follows:</p><figure name="ef9d" id="ef9d" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 590px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 84.3%;"></div><img class="graf-image" data-image-id="1*sKrK7VgF8dHvYMoiIjZtSA.png" data-width="1468" data-height="1238" src="https://cdn-images-1.medium.com/max/800/1*sKrK7VgF8dHvYMoiIjZtSA.png"></div><figcaption class="imageCaption">Recursive relation for Sum of Distances, in its totality.</figcaption></figure><h3 name="55ef" id="55ef" class="graf graf--h3 graf-after--figure">Did I just see “MEMOIZATION” in the code?</h3><p name="464c" id="464c" class="graf graf--p graf-after--h3">Yes, indeed you did!</p><p name="97be" id="97be" class="graf graf--p graf-after--p">Consider the following example tree:</p><figure name="5f8a" id="5f8a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 665px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 95%;"></div><img class="graf-image" data-image-id="1*SkgBwbCP1O6-wrS4u2WlZg.png" data-width="1398" data-height="1328" src="https://cdn-images-1.medium.com/max/800/1*SkgBwbCP1O6-wrS4u2WlZg.png"></div><figcaption class="imageCaption">Example of a skewed tree, also recursive calls for the vertex 5</figcaption></figure><p name="f86c" id="f86c" class="graf graf--p graf-after--figure">The question asks us to find the sum of distances for all the nodes in the given tree. So, we would do something like this:</p><pre name="8cbc" id="8cbc" class="graf graf--pre graf-after--p">for i in range(N):<br>    ans.append(find_distances(N))</pre><p name="6a1b" id="6a1b" class="graf graf--p graf-after--pre">But, if you look at the tree above, the recursive call for the node <code class="markup--code markup--p-code">5</code> would end up calculating the answers for all the nodes in the tree. So, we don’t need to recalculate the answers for the other nodes again and again.</p><p name="6d29" id="6d29" class="graf graf--p graf-after--p">Hence, we end up storing the already calculated values in a dictionary and use that in further calculations.</p><p name="0bd1" id="0bd1" class="graf graf--p graf-after--p">Essentially, the recursion is based on the parent of a node, and multiple nodes can have the same parent. So, the answer for the parent should only be calculated once and then be used again and again.</p><p name="9e13" id="9e13" class="graf graf--p graf-after--p">If you’ve managed to read the article this far (not necessarily in one stretch 😛), you’re awesome 😃.</p><figure name="eeb6" id="eeb6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 864px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 123.4%;"></div><img class="graf-image" data-image-id="1*3vTs6DvYvHOIG_l2aeiRHw.jpeg" data-width="900" data-height="1111" src="https://cdn-images-1.medium.com/max/800/1*3vTs6DvYvHOIG_l2aeiRHw.jpeg"></div><figcaption class="imageCaption">Source: <a href="http://doodlecats.com/youre-awesome" data-href="http://doodlecats.com/youre-awesome" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">http://doodlecats.com/youre-awesome</a></figcaption></figure><p name="5895" id="5895" class="graf graf--p graf-after--figure graf--trailing">If you found this article helpful, share as much as possible and spread the 💛. Cheers!</p></div></div></section>
</section>
</article></body></html>-->
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2018/07/12/Explore-the-applications-and-limits-of-Breadth-First-Search-to-the-shortest-paths-in-a-weighted-1e7b28b3307/">
        Breadth First Search and its application to shortest paths in weighted graphs
      </a>
    </h1>

    <span class="post-date">12 Jul 2018</span>
  
    
    <!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Explore the applications and limits of Breadth First Search to the shortest paths in a weighted…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Explore the applications and limits of Breadth First Search to the shortest paths in a weighted…</h1>
</header>
<section data-field="subtitle" class="p-summary">
Do you know the amount of global air traffic in 2017? Do you know what the rise has been for air traffic over the past several years …
</section>
<section data-field="body" class="e-content">
<section name="998b" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3be3" id="3be3" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--outsetColumn"><figure name="1fed" id="1fed" class="graf graf--figure graf--layoutOutsetCenter graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 1111px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 111.1%;"></div><img class="graf-image" data-image-id="1*Dn4pxbJWrya6g1h0NNhaHw.png" data-width="1768" data-height="1964" src="https://cdn-images-1.medium.com/max/1000/1*Dn4pxbJWrya6g1h0NNhaHw.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="b3eb" id="b3eb" class="graf graf--p graf-after--figure">Do you know the amount of global air traffic in 2017? Do you know what the rise has been for air traffic over the past several years ? Well, lets look at some statistics.
    <br>
    <a href="/2018/07/12/Explore-the-applications-and-limits-of-Breadth-First-Search-to-the-shortest-paths-in-a-weighted-1e7b28b3307/">
         Read More...
    </a>
    <hr>
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Explore the applications and limits of Breadth First Search to the shortest paths in a weighted…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Explore the applications and limits of Breadth First Search to the shortest paths in a weighted…</h1>
</header>
<section data-field="subtitle" class="p-summary">
Do you know the amount of global air traffic in 2017? Do you know what the rise has been for air traffic over the past several years …
</section>
<section data-field="body" class="e-content">
<section name="998b" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3be3" id="3be3" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--outsetColumn"><figure name="1fed" id="1fed" class="graf graf--figure graf--layoutOutsetCenter graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 1111px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 111.1%;"></div><img class="graf-image" data-image-id="1*Dn4pxbJWrya6g1h0NNhaHw.png" data-width="1768" data-height="1964" src="https://cdn-images-1.medium.com/max/1000/1*Dn4pxbJWrya6g1h0NNhaHw.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="b3eb" id="b3eb" class="graf graf--p graf-after--figure">Do you know the amount of global air traffic in 2017? Do you know what the rise has been for air traffic over the past several years ? Well, lets look at some statistics.  <figure name="c998" id="c998" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 462px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.10000000000001%;"></div><img class="graf-image" data-image-id="1*-YOA5JTQ68fJCixUUBYQ2A.png" data-width="1444" data-height="954" src="https://cdn-images-1.medium.com/max/800/1*-YOA5JTQ68fJCixUUBYQ2A.png"></div><figcaption class="imageCaption">Source: <a href="https://www.statista.com/statistics/564769/airline-industry-number-of-flights/" data-href="https://www.statista.com/statistics/564769/airline-industry-number-of-flights/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.statista.com/statistics/564769/airline-industry-number-of-flights/</a></figcaption></figure><p name="7616" id="7616" class="graf graf--p graf-after--figure">According to the <a href="https://www.icao.int/Pages/default.aspx" data-href="https://www.icao.int/Pages/default.aspx" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">International Civil Aviation Organization</a> (ICAO), a record 4.1 billion passengers were carried by the aviation industry on scheduled services in 2017. And, the number of flights rose to 37 million globally in 2017.-->
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Explore the applications and limits of Breadth First Search to the shortest paths in a weighted…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Explore the applications and limits of Breadth First Search to the shortest paths in a weighted…</h1>
</header>
<section data-field="subtitle" class="p-summary">
Do you know the amount of global air traffic in 2017? Do you know what the rise has been for air traffic over the past several years …
</section>
<section data-field="body" class="e-content">
<section name="998b" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3be3" id="3be3" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--outsetColumn"><figure name="1fed" id="1fed" class="graf graf--figure graf--layoutOutsetCenter graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 1111px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 111.1%;"></div><img class="graf-image" data-image-id="1*Dn4pxbJWrya6g1h0NNhaHw.png" data-width="1768" data-height="1964" src="https://cdn-images-1.medium.com/max/1000/1*Dn4pxbJWrya6g1h0NNhaHw.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="b3eb" id="b3eb" class="graf graf--p graf-after--figure">Do you know the amount of global air traffic in 2017? Do you know what the rise has been for air traffic over the past several years ? Well, lets look at some statistics.</p><figure name="c998" id="c998" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 462px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.10000000000001%;"></div><img class="graf-image" data-image-id="1*-YOA5JTQ68fJCixUUBYQ2A.png" data-width="1444" data-height="954" src="https://cdn-images-1.medium.com/max/800/1*-YOA5JTQ68fJCixUUBYQ2A.png"></div><figcaption class="imageCaption">Source: <a href="https://www.statista.com/statistics/564769/airline-industry-number-of-flights/" data-href="https://www.statista.com/statistics/564769/airline-industry-number-of-flights/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.statista.com/statistics/564769/airline-industry-number-of-flights/</a></figcaption></figure><p name="7616" id="7616" class="graf graf--p graf-after--figure">According to the <a href="https://www.icao.int/Pages/default.aspx" data-href="https://www.icao.int/Pages/default.aspx" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">International Civil Aviation Organization</a> (ICAO), a record 4.1 billion passengers were carried by the aviation industry on scheduled services in 2017. And, the number of flights rose to 37 million globally in 2017.</p><p name="6b4b" id="6b4b" class="graf graf--p graf-after--p">That’s a lot of passengers and a lot of flights occupying the air space on a daily basis across the world. Since there are hundreds and thousands of these flights all around the globe, there are bound to be different routes with multiple stops in between from one place to another.</p><p name="ae31" id="ae31" class="graf graf--p graf-after--p">Every flight has a source and destination of its own and a standard economy seat price associated with it. Let’s leave out the fancy business class tickets and extra leg room and what not!</p><p name="f8e0" id="f8e0" class="graf graf--p graf-after--p">In such a scenario, it is too confusing to choose what flight would be the best one if we want to go from one place to another.</p><p name="723a" id="723a" class="graf graf--p graf-after--p">Let’s see the number of flight options <a href="https://www.studentuniverse.com/?noMoreRedirect=true" data-href="https://www.studentuniverse.com/?noMoreRedirect=true" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">StudentUniverse</a> (provides discounts for students 😜) gives me from Los Angeles to New Delhi.</p><figure name="251c" id="251c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 644px; max-height: 110px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 17.1%;"></div><img class="graf-image" data-image-id="1*ws_g1WoN2gol45O7xgUf9g.png" data-width="644" data-height="110" src="https://cdn-images-1.medium.com/max/800/1*ws_g1WoN2gol45O7xgUf9g.png"></div><figcaption class="imageCaption">Every flight has a Details hyperlink with it, so we searched for that and found 119 total flights.</figcaption></figure><p name="693c" id="693c" class="graf graf--p graf-after--figure">119 total flights are being offered. Then there appears a pop up on the website saying that there are other websites that might be offering similar flights at even cheaper rates. 😩</p><p name="6cae" id="6cae" class="graf graf--p graf-after--p">So many websites and uncountable flights for just a single source and destination.</p><p name="a366" id="a366" class="graf graf--p graf-after--p">As a developer, if I want to solve this problem, I would build a system to efficiently address the following queries:</p><ul class="postList"><li name="2ad8" id="2ad8" class="graf graf--li graf-after--p">Total number of destinations reachable (with a max number of stops) from my current location, and also list those destinations.<br>One should keep their options open when they want to travel 😃.</li><li name="6c12" id="6c12" class="graf graf--li graf-after--li">It is a known fact (IMO 😉) that a route with multiple stops tends to be a cheaper alternative to direct flights.<br>So, given a source and a destination, we may want to find routes with at least 2 or 3 stops.</li><li name="3f2b" id="3f2b" class="graf graf--li graf-after--li">Most importantly: What is the cheapest route from a given source to a given destination?</li><li name="aff4" id="aff4" class="graf graf--li graf-after--li">And…. We’ll come to this one in the end 🙈.</li></ul><p name="f5a0" id="f5a0" class="graf graf--p graf-after--li">As you might guess, there would be potentially thousands of flights as the output of the first two queries. But we can certainly reduce that by providing some other criteria to lessen the output size. For the scope of this article, let us focus on these original queries themselves.</p><h3 name="b6ca" id="b6ca" class="graf graf--h3 graf-after--p">Modeling the Flight Network as a Graph</h3><p name="0465" id="0465" class="graf graf--p graf-after--h3">It’s pretty clear from the headline of this article that graphs would be involved somewhere, isn’t it?</p><p name="c5f3" id="c5f3" class="graf graf--p graf-after--p">Modeling this problem as a graph traversal problem greatly simplifies it and makes the problem much more tractable. So, as a first step, let us define our graph.</p><p name="bf72" id="bf72" class="graf graf--p graf-after--p">We model the air traffic as a:</p><ul class="postList"><li name="10a8" id="10a8" class="graf graf--li graf-after--p">directed</li><li name="e571" id="e571" class="graf graf--li graf-after--li">possibly cyclic</li><li name="e3f8" id="e3f8" class="graf graf--li graf-after--li">weighted</li><li name="e032" id="e032" class="graf graf--li graf-after--li">forest. <strong class="markup--strong markup--li-strong">G (V, E)</strong></li></ul><p name="07f2" id="07f2" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Directed</strong> because every flight will have a designated source and a destination. These carry a lot of meaning.</p><p name="bce3" id="bce3" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Cyclic</strong> because it is very possible to follow a bunch of flights starting from a given location and ending back at the same location.</p><p name="1bd7" id="1bd7" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Weighted</strong> because every flight has a cost associated with it which would be the economy class flight ticket for this article.</p><p name="4794" id="4794" class="graf graf--p graf-after--p">And finally, a <strong class="markup--strong markup--p-strong">forest</strong> because we might have multiple connected components. It is not necessary that all the cities in the world have some sort of flight network between them. So, the graph can be disconnected, and hence a forest.</p><p name="f2a0" id="f2a0" class="graf graf--p graf-after--p">The vertices, <strong class="markup--strong markup--p-strong">V</strong>, would be the locations all over the world wherever there are working airports.</p><p name="f4dc" id="f4dc" class="graf graf--p graf-after--p">The edges, <strong class="markup--strong markup--p-strong">E</strong>, would be representative of all the flights constituting the air traffic. An edge from <code class="markup--code markup--p-code">u --&gt; v</code> simply means you have a directed flight from the location / node <code class="markup--code markup--p-code">u</code> to <code class="markup--code markup--p-code">v</code> .</p><figure name="d8fd" id="d8fd" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 1142px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 163.2%;"></div><img class="graf-image" data-image-id="1*EVmPCv1BmJ7A1WMl5P2urQ.png" data-width="1064" data-height="1736" src="https://cdn-images-1.medium.com/max/800/1*EVmPCv1BmJ7A1WMl5P2urQ.png"></div><figcaption class="imageCaption">Sample flight network with the cost labelling for different flights.</figcaption></figure><p name="2a1f" id="2a1f" class="graf graf--p graf-after--figure">Now that we have an idea about how to model the flight network as a graph, let us move on and solve the first common query that a user might have.</p><h3 name="b16d" id="b16d" class="graf graf--h3 graf-after--p">Total Number of Destinations Reachable</h3><p name="f79b" id="f79b" class="graf graf--p graf-after--h3">Who doesn’t like to travel?</p><p name="d09c" id="d09c" class="graf graf--p graf-after--p">As someone who likes to explore different places, you would want to know what all destinations are reachable from your local airport. Again, there would be additional criteria here to reduce the results of this query. But to keep things simple, we will simply try and find all the locations reachable from our local airport.</p><p name="f5c8" id="f5c8" class="graf graf--p graf-after--p">Now that we have a well defined graph, we can apply traversal algorithms to process it.</p><p name="8a59" id="8a59" class="graf graf--p graf-after--p">Starting off from a given point, we can use either <a href="https://en.wikipedia.org/wiki/Breadth-first_search" data-href="https://en.wikipedia.org/wiki/Breadth-first_search" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Breadth First Search</a> (BFS) or <a href="https://en.wikipedia.org/wiki/Depth-first_search" data-href="https://en.wikipedia.org/wiki/Depth-first_search" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Depth First Search</a> (DFS) to explore the graph or the locations reachable from the starting location <strong class="markup--strong markup--p-strong">within a maximum number of stops.</strong> Since this article is all about the breadth first search algorithm, let’s look at how we can use the famous BFS to accomplish this task.</p><p name="7b2e" id="7b2e" class="graf graf--p graf-after--p">We will initialize the BFS queue with the given location as the starting point. We then perform the breadth first traversal, and keep going until the queue is empty or until the maximum number of stops have been exhausted.</p><p name="3d23" id="3d23" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Note: </strong>If you are not familiar with the breadth first search or depth first search, I would recommend going through <a href="https://medium.freecodecamp.org/deep-dive-into-graph-traversals-227a90c6a261" data-href="https://medium.freecodecamp.org/deep-dive-into-graph-traversals-227a90c6a261" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">this article</a> before continuing.</p><p name="94b0" id="94b0" class="graf graf--p graf-after--p">Let’s look at the code to initialize our graph data structure. We also need to look at how the BFS algorithm would end up giving us all the destinations reachable from a given source.</p><figure name="ffe4" id="ffe4" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/c0ac66eefc34c3d011c9d5d2ea292716.js"></script><figcaption class="imageCaption">Some Random set of flights with source, destination and their prices.</figcaption></figure><p name="d5b0" id="d5b0" class="graf graf--p graf-after--figure">Now that we have a good idea about how the graph is to be initialized, let’s look at the code for the BFS algorithm.</p><figure name="0fff" id="0fff" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/61d9089e3b7da91c4c528b3bcc736be9.js"></script></figure><p name="7aee" id="7aee" class="graf graf--p graf-after--figure">Performing <code class="markup--code markup--p-code">bfs</code> on the city of Los Angeles would give us the following destinations which are reachable:</p><pre name="436b" id="436b" class="graf graf--pre graf-after--p">{&#39;Chicago&#39;, &#39;France&#39;, &#39;Ireland&#39;, &#39;Italy&#39;, &#39;Japan&#39;, &#39;New Delhi&#39;, &#39;Norway&#39;}</pre><p name="99ac" id="99ac" class="graf graf--p graf-after--pre">That was simple, wasn’t it?</p><p name="c34e" id="c34e" class="graf graf--p graf-after--p">We will look at how we can limit the BFS to a maximum number of stops later on in the article.</p><p name="6fc3" id="6fc3" class="graf graf--p graf-after--p">In case we have a humongous flight network, which we would have in a production scenario, then we would not ideally want to explore all the reachable destinations from a given starting point.</p><p name="b214" id="b214" class="graf graf--p graf-after--p">This is a use case if the flight network is very small or pertains only to a few regions in the United States.</p><p name="62d3" id="62d3" class="graf graf--p graf-after--p">But, for a large network, a more realistic use case would be to find all the flight routes with multiple stops. Let us look at this problem in some more detail and see how we can solve it.</p><h3 name="4906" id="4906" class="graf graf--h3 graf-after--p">Routes with multiple stops</h3><p name="790b" id="790b" class="graf graf--p graf-after--h3">It is a well known fact that more often than not, for a given source and destination, a multi stop trip is cheaper than a direct, non-stop flight.</p><p name="50cb" id="50cb" class="graf graf--p graf-after--p">A lot of times we prefer the direct flight to avoid the layovers. Also because the multi-stop flights do tend to take a lot of time — which we don’t have.</p><p name="129f" id="129f" class="graf graf--p graf-after--p">However, if you don’t have any deadlines approaching and you want to save some bucks (and are comfortable with the multi-stop route that a lot of airlines suggest), then you might actually benefit a lot from something like this.</p><p name="460a" id="460a" class="graf graf--p graf-after--p">Also, you might get to pass through some of the most beautiful locations in the world with some of the most advanced airports which you can enjoy. So, that’s enough motivation as it is.</p><p name="d1f6" id="d1f6" class="graf graf--p graf-after--p">In terms of the graph model that we have been talking about, given a source and a destination, we need to come up with routes with 2 or more stops for a given source and destination.</p><p name="afe9" id="afe9" class="graf graf--p graf-after--p">As an end user, we might not want to see flights in this order for this query:</p><pre name="d2c8" id="d2c8" class="graf graf--pre graf-after--p">[A, C, D, B], 2 stops, $X<br>[A, E, D, C, F, W, G, T, B], 8 stops, $M<br>[A, R, E, G, B], 3 stops, $K<br>[A, Z, X, C, V, B, N, S, D, F, G, H, B, 11 stops, $P</pre><p name="ac18" id="ac18" class="graf graf--p graf-after--pre">I know. Nobody in their right minds would want to go for a flight route with 11 stops. But the point I’m trying to make is that an end user would want symmetry. Meaning that they would want to see all the flights with 2 stops first, then all the flights with 3 stops and so on till maybe a max of, say, 5 stops.</p><p name="3c79" id="3c79" class="graf graf--p graf-after--p">But, all the flight routes with the same number of stops in between should be displayed together. That is a requirement we need to satisfy.</p><p name="4348" id="4348" class="graf graf--p graf-after--p">Let’s look at how we can solve this. So, given the graph of flight networks, a source <code class="markup--code markup--p-code">S</code> and a destination <code class="markup--code markup--p-code">D</code>, we have to perform a level order traversal and report flight routes from <code class="markup--code markup--p-code">S --&gt; D</code> with at least 2 and at most 5 stops in between. This means we have to do a level order traversal until a depth of 7 from the start node <code class="markup--code markup--p-code">S</code> .</p><p name="c933" id="c933" class="graf graf--p graf-after--p">Have a look at the code for solving this problem:</p><figure name="5c38" id="5c38" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/ce915542048558003d4395954ae5aa87.js"></script></figure><p name="af57" id="af57" class="graf graf--p graf-after--figure">This might not be the best way to go about solving this problem at scale — the largest memory constraint would be due to the nodes currently present in the queue.</p><p name="ac62" id="ac62" class="graf graf--p graf-after--p">Since every node or location can have thousands of flights to other destinations in the world, the queue could be humongous if we store actual flight data like this. This is just to demonstrate one of the use cases of the breadth first search algorithm.</p><p name="0365" id="0365" class="graf graf--p graf-after--p">Now, let us just focus on the traversal and look at the way it is done. The traversal algorithm is simple as it is. However, the entire space complexity of the level order traversal comes from the elements in the queue and the size of each element.</p><p name="8978" id="8978" class="graf graf--p graf-after--p">There are multiple ways to implement the algorithm. Also, each of them varies in terms of maximum memory consumed at any given time by the elements in the queue.</p><p name="50ec" id="50ec" class="graf graf--p graf-after--p">We want to see the maximum memory consumed by the queue at any point in time during the level order traversal. Before that, let’s construct a random flight network with random prices.</p><figure name="8dd5" id="8dd5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/12e604c3328ddfb8544ffbbeeb14349b.js"></script></figure><p name="fe98" id="fe98" class="graf graf--p graf-after--figure">Now let us look at the implementation of level order traversal.</p><figure name="4559" id="4559" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/713b7dc200b6cfb614b96cde4b01a4d1.js"></script></figure><p name="4f33" id="4f33" class="graf graf--p graf-after--figure">This above is the easiest and most straightforward implementation of the level order traversal algorithm.</p><p name="f25b" id="f25b" class="graf graf--p graf-after--p">With every node we add to the queue, we also store the level information and we push a tuple of <code class="markup--code markup--p-code">(node, level)</code> into the queue. So every time we pop an element from the queue, we have the level information attached with the node itself.</p><p name="104f" id="104f" class="graf graf--p graf-after--p">The level information for our use case would mean the number of stops from the source to this location in the flight route.</p><p name="945a" id="945a" class="graf graf--p graf-after--p">It turns out that we can do better as far as memory consumption of the program is concerned. Let us look at a slightly better approach to doing level order traversal.</p><figure name="ffe2" id="ffe2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/752ccbd0cd09818967ca8643874a1ea4.js"></script></figure><p name="a63c" id="a63c" class="graf graf--p graf-after--figure">The idea here is that we don’t store any additional information with the nodes being pushed into the queue. We use a <code class="markup--code markup--p-code">None</code> object to mark the end of a given level. We don’t know the size of any level before hand except for the first level, which just has our <code class="markup--code markup--p-code">source</code> node.</p><p name="af52" id="af52" class="graf graf--p graf-after--p">So, we start the queue with <code class="markup--code markup--p-code">[source, None]</code> and we keep popping elements. Every time we encounter a <code class="markup--code markup--p-code">None</code> element, we know that a level has ended and a new one has started. We push another <code class="markup--code markup--p-code">None</code> to mark the end of this new level.</p><p name="5d28" id="5d28" class="graf graf--p graf-after--p">Consider a very simple graph here, and then we will dry run this through the graph.</p><figure name="566e" id="566e" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 759px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 108.4%;"></div><img class="graf-image" data-image-id="1*TYLcK8LGHr2CfeNZ1CBg7w.png" data-width="1336" data-height="1448" src="https://cdn-images-1.medium.com/max/800/1*TYLcK8LGHr2CfeNZ1CBg7w.png"></div></figure><pre name="6769" id="6769" class="graf graf--pre graf-after--figure">**************************************************** LEVEL 0 begins<br>level = 0, queue = [A, None]<br>level = 0, pop, A, push, B, C, queue = [None, B, C]<br>pop None ******************************************* LEVEL 1 begins<br>push None<br>level = 1, queue = [B, C, None]<br>level = 1, pop, B, push, C, D, F, queue = [C, None, C, D, F]<br>level = 1, pop, C, push, D, D (lol!), queue = [None, C, D, F, D, D]<br>pop None ******************************************* LEVEL 2 begins<br>push None<br>level = 2, queue = [C, D, F, D, D, None] .... and so on</pre><p name="6714" id="6714" class="graf graf--p graf-after--pre">I hope this sums up the algorithm pretty well. This certainly is a neat trick to do level order traversal, keep track of the levels, and not encounter too much of a memory concern. This certainly reduces the memory footprint of the code.</p><p name="cc40" id="cc40" class="graf graf--p graf-after--p">Don’t get complacent now thinking this is a great improvement.</p><p name="c7ab" id="c7ab" class="graf graf--p graf-after--p">It is, but you should be asking two questions:</p><ol class="postList"><li name="37cc" id="37cc" class="graf graf--li graf-after--p">How big of an improvement is this?</li><li name="dff9" id="dff9" class="graf graf--li graf-after--li">Can we do better?</li></ol><p name="37ed" id="37ed" class="graf graf--p graf-after--li">I will answer both of these questions now starting with the second question. The answer to that is Yes!</p><p name="c688" id="c688" class="graf graf--p graf-after--p">We can do one better here and completely do away with the need for the <code class="markup--code markup--p-code">None</code> in the queue. The motivation for this approach comes from the previous approach itself.</p><p name="f833" id="f833" class="graf graf--p graf-after--p">If you look closely at the dry run above, you can see that every time we pop a <code class="markup--code markup--p-code">None</code>, one level is finished and the other one is ready for processing. The important thing is that an entire next level exists in the queue at the time of popping of a <code class="markup--code markup--p-code">None</code> . We can make use of this idea of considering the queue size into the traversal logic.</p><p name="d75b" id="d75b" class="graf graf--p graf-after--p">Here is the pseudo code for this improved algorithm:</p><pre name="04b2" id="04b2" class="graf graf--pre graf-after--p">queue = Queue()<br>queue.push(S)<br>level = 0<br>while queue is not empty {<br>      size = queue.size()<br>      // size represents the number of elements in the current level<br>      for i in 1..size {<br>          element = queue.pop()<br>          // Process element here<br>          // Perform a series of queue.push() operations here</pre><pre name="4057" id="4057" class="graf graf--pre graf-after--pre">      level += 1</pre><p name="16b4" id="16b4" class="graf graf--p graf-after--pre">And here is the code for the same.</p><figure name="b9e6" id="b9e6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/c656c837cfa21115e8f05aaaef0056e9.js"></script></figure><p name="8c97" id="8c97" class="graf graf--p graf-after--figure">The pseudo code is self explanatory. We essentially do away with the need for an extra <code class="markup--code markup--p-code">None</code> element per level and instead make use of the queue’s size to change levels. This would also lead to improvement over the last method, but how much?</p><p name="f0a6" id="f0a6" class="graf graf--p graf-after--p">Have a look at the following Jupyter Notebook to see the memory difference between the three methods.</p><figure name="106a" id="106a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/34dbb527af37ba4d9da8076d9039767c.js"></script></figure><ul class="postList"><li name="2b06" id="2b06" class="graf graf--li graf-after--figure">We track the maximum size of the queue at any time by considering the sum of sizes of individual queue elements.</li><li name="fcd8" id="fcd8" class="graf graf--li graf-after--li">According to Python’s documentation, <code class="markup--code markup--li-code">sys.getsizeof</code> returns the object’s pointer or reference’s size in bytes. So, we saved almost 4.4Kb space <code class="markup--code markup--li-code">(20224 — 15800 bytes)</code> by switching to the <code class="markup--code markup--li-code">None</code> method from the original level order traversal method. This is just the memory savings for this random example, and we went only until the 5th level in the traversal.</li><li name="e30f" id="e30f" class="graf graf--li graf-after--li">The final method only gives an improvement of 16 bytes over the <code class="markup--code markup--li-code">None</code> method. This is because we got rid of just 4 <code class="markup--code markup--li-code">None</code> objects which were being used to mark the 4 levels (apart from the first one) that we processed. Each pointer’s size (pointer to an object) is 4 bytes in Python on a 32 bit system.</li></ul><p name="82a9" id="82a9" class="graf graf--p graf-after--li">Now that we have all these interesting multi-path routes from our source to our destination and highly efficient level order traversal algorithms to solve it, we can look at a more lucrative problem to solve using our very own BFS.</p><p name="eb69" id="eb69" class="graf graf--p graf-after--p">What’s the cheapest flight route from my source to a given destination? This is something everybody would be instantly interested in. I mean who doesn’t want to save some bucks?</p><h3 name="c5b7" id="c5b7" class="graf graf--h3 graf-after--p">Shortest Path from a given source to destination</h3><p name="d7cc" id="d7cc" class="graf graf--p graf-after--h3">There’s not much description to give for the problem statement. We just need to find the shortest path and make the end user happy.</p><p name="b25d" id="b25d" class="graf graf--p graf-after--p">Algorithmically, given a weighted directed graph, we need to find the shortest path from source to destination. Shortest or cheapest would be one and the same thing from the point of the view of the algorithm.</p><p name="e1ea" id="e1ea" class="graf graf--p graf-after--p">We will not go into describing a possible BFS solution to this problem because such a solution would be intractable. Let us look at the graph below to understand why that is the case.</p><figure name="e200" id="e200" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 1032px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 147.5%;"></div><img class="graf-image" data-image-id="1*ZaqHLSc9r19WVqSE_YLAPg.png" data-width="1158" data-height="1708" src="https://cdn-images-1.medium.com/max/800/1*ZaqHLSc9r19WVqSE_YLAPg.png"></div></figure><p name="da53" id="da53" class="graf graf--p graf-after--figure">We say that BFS is the algorithm to use if we want to find the <strong class="markup--strong markup--p-strong">shortest path</strong> in an <a href="https://medium.freecodecamp.org/deep-dive-into-graph-traversals-227a90c6a261" data-href="https://medium.freecodecamp.org/deep-dive-into-graph-traversals-227a90c6a261" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">undirected, unweighted graph</a><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">. </em></strong>The claim for BFS is that the first time a node is discovered during the traversal, that distance from the source would give us the shortest path.</p><p name="28ee" id="28ee" class="graf graf--p graf-after--p">The same cannot be said for a weighted graph. Consider the graph above. If say we were to find the shortest path from the node <code class="markup--code markup--p-code">A</code> to <code class="markup--code markup--p-code">B</code> in the undirected version of the graph, then the shortest path would be the direct link between A and B. So, the shortest path would be of length <code class="markup--code markup--p-code">1</code> and BFS would correctly find this for us.</p><p name="b91f" id="b91f" class="graf graf--p graf-after--p">However, we are dealing with a weighted graph here. So, the first discovery of a node during traversal <strong class="markup--strong markup--p-strong">does not guarantee</strong> the shortest path for that node. For example, in the diagram above, the node <code class="markup--code markup--p-code">B</code> would be discovered initially because it is the neighbor of <code class="markup--code markup--p-code">A</code> and the cost associated with this path (an edge in this case) would be <code class="markup--code markup--p-code">25</code> . But, this is not the shortest path. The shortest path is <code class="markup--code markup--p-code">A --&gt; M --&gt; E --&gt; B</code> of length <code class="markup--code markup--p-code">10</code>.</p><p name="4e90" id="4e90" class="graf graf--p graf-after--p">Breadth first search has no way of knowing if a particular discovery of a node would give us the shortest path to that node. And so, the only possible way for BFS (or DFS) to find the shortest path in a weighted graph is to search the entire graph and keep recording the minimum distance from source to the destination vertex.</p><p name="a88b" id="a88b" class="graf graf--p graf-after--p">This solution is not feasible for a huge network like our flight network that would have potentially thousands of nodes.</p><p name="9441" id="9441" class="graf graf--p graf-after--p">We won’t go into the details of how we can solve this. That is out of scope for this article.</p><p name="6cc2" id="6cc2" class="graf graf--p graf-after--p">What if I told you that BFS is just the right algorithm to find the shortest path in a weighted graph <strong class="markup--strong markup--p-strong">with a slight constraint</strong> ?</p><figure name="f3e3" id="f3e3" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://giphy.com/embed/a5viI92PAF89q/twitter/iframe" width="435" height="300" frameborder="0" scrolling="no"></iframe><figcaption class="imageCaption">Source: <a href="https://giphy.com/gifs/reaction-a5viI92PAF89q" data-href="https://giphy.com/gifs/reaction-a5viI92PAF89q" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://giphy.com/gifs/reaction-a5viI92PAF89q</a></figcaption></figure><h3 name="c3c6" id="c3c6" class="graf graf--h3 graf-after--figure">Constrained Shortest Paths</h3><p name="b293" id="b293" class="graf graf--p graf-after--h3">Since the graph we would have for the flight network is humongous, we know that exploring it completely is not really a possibility.</p><p name="46da" id="46da" class="graf graf--p graf-after--p">Consider the problem of shortest paths from the customer’s perspective. When you want to book a flight, these are the following options you ideally consider:</p><ul class="postList"><li name="c75b" id="c75b" class="graf graf--li graf-after--p">It shouldn’t be too long a flight.</li><li name="32cd" id="32cd" class="graf graf--li graf-after--li">It should be under your budget (Very Important).</li><li name="ab5b" id="ab5b" class="graf graf--li graf-after--li">It may have multiple stops but not more than <code class="markup--code markup--li-code">K</code> where <code class="markup--code markup--li-code">K</code> can vary from person to person.</li><li name="a964" id="a964" class="graf graf--li graf-after--li">Finally we have personal preferences which involve things like lounge access, food quality, layover locations, and average leg room.</li></ul><p name="002e" id="002e" class="graf graf--p graf-after--li">The important point to consider here is the third one above: it may have multiple stops, but not more than <code class="markup--code markup--p-code">K</code> where <code class="markup--code markup--p-code">K</code> can vary from person to person.</p><p name="24be" id="24be" class="graf graf--p graf-after--p">A customer wants the cheapest flight route, but they also don’t want say 20 stops in between their source and destination. A customer might be okay with a maximum of 3 stops, or in extreme cases maybe even 4 — but not more than that.</p><p name="7a50" id="7a50" class="graf graf--p graf-after--p">We would want an application that would find out the cheapest flight route with <a href="https://leetcode.com/problems/cheapest-flights-within-k-stops/description/" data-href="https://leetcode.com/problems/cheapest-flights-within-k-stops/description/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">at most K stops</a> for a given source and destination.</p><figure name="a46b" id="a46b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 412px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 58.8%;"></div><img class="graf-image" data-image-id="1*4_xEqai9idr89T1L6bHfeQ.png" data-width="2176" data-height="1280" src="https://cdn-images-1.medium.com/max/800/1*4_xEqai9idr89T1L6bHfeQ.png"></div><figcaption class="imageCaption">Source: Leetcode.com</figcaption></figure><p name="fb2d" id="fb2d" class="graf graf--p graf-after--figure">This question from LeetCode has been the primary motivation for me to write this article. I strongly recommend going through the question once and not only relying on the snapshot above.</p><p name="c64f" id="c64f" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Why would BFS work here?” one might ask. “This is also a weighted graph and the same reason for the failure of BFS that we discussed in the previous section should apply here.” NO!</p><p name="5b01" id="5b01" class="graf graf--p graf-after--p">The number of levels that the search would go to is limited by the value <code class="markup--code markup--p-code">K</code> in the question or in the description provided at the start of section. So, essentially, we would be trying to find the shortest path, but we won’t have to explore the entire graph as such. We will just go up to the level <code class="markup--code markup--p-code">K</code>.</p><p name="2532" id="2532" class="graf graf--p graf-after--p">From a real life scenario, the value of <code class="markup--code markup--p-code">K</code> would be under 5 for any sane traveler 😝.</p><p name="f0ee" id="f0ee" class="graf graf--p graf-after--p">Let us look at the pseudo-code for the algorithm:</p><pre name="5d09" id="5d09" class="graf graf--pre graf-after--p">def bfs(source, destination, K):<br>      min_cost = dictionary representing min cost under K stops for each node reachable from source. </pre><pre name="0b6b" id="0b6b" class="graf graf--pre graf-after--pre">      set min_cost of source to be 0</pre><pre name="9c6b" id="9c6b" class="graf graf--pre graf-after--pre">      Q = queue()<br>      Q.push(source)<br>      stops = 0<br>      while Q is not empty {</pre><pre name="a8ee" id="a8ee" class="graf graf--pre graf-after--pre">           size = Q.size<br>           for i in range 1..size {<br>                 element = Q.pop() </pre><pre name="78d5" id="78d5" class="graf graf--pre graf-after--pre">                 if element == destination then continue</pre><pre name="fe6c" id="fe6c" class="graf graf--pre graf-after--pre">                 for neighbor in adjacency list of element {<br>                        if stops == K and neighbor != destination        then continue  </pre><pre name="d1d6" id="d1d6" class="graf graf--pre graf-after--pre">                        if min_cost of neighbor improves, update and add back to the queue.<br>                }<br>           }    <br>           stops ++ <br>      }</pre><p name="4c7a" id="4c7a" class="graf graf--p graf-after--pre">This again is level order traversal and the approach being used here is the one that makes use of the queue’s size at every level. Let us look at a commented version of the code to solve this problem.</p><figure name="6046" id="6046" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/edorado93/4655b45ae1d93e95390f5bcee80116cf.js"></script></figure><p name="fae8" id="fae8" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Essentially, we keep track of the minimum distance of every node from the given source. The minimum distance for the source would be 0 and +inf for all others initially.</strong></p><p name="7d18" id="7d18" class="graf graf--p graf-after--p">Whenever we encounter a node, we check if the current minimum path length can be improved or not. If it can be improved, that means that we have found an alternate path from source to this vertex with cheaper cost — a cheaper flight route until this vertex. We queue this vertex again so that locations and nodes reachable from this vertex on are updated (may or may not be) as well.</p><p name="6bfa" id="6bfa" class="graf graf--p graf-after--p">The key thing is this:</p><pre name="96b5" id="96b5" class="graf graf--pre graf-after--p"># No need to update the minimum cost if we have already exhausted our K stops. <br>if stops == K and neighbor != dst:<br>    continue</pre><p name="3a15" id="3a15" class="graf graf--p graf-after--pre">So we just popped the a node represented by <code class="markup--code markup--p-code">element</code> in the code and <code class="markup--code markup--p-code">neighbor</code> can either be a destination or a random other node. If we have already exhausted our <code class="markup--code markup--p-code">K</code> stops with the <code class="markup--code markup--p-code">element</code> being the <code class="markup--code markup--p-code">Kth</code> stop, then we shouldn’t process and update (possibly) the minimum distance for <code class="markup--code markup--p-code">neighbor</code>. This would violate our maximum <code class="markup--code markup--p-code">K</code> stops condition in that case.</p><p name="4518" id="4518" class="graf graf--p graf-after--p">As it turns out, I solved this problem originally using Dynamic Programming and it took around 165ms to run on the LeetCode platform. I ran using BFS and it was blazing fast with just 45ms to execute. Motivation enough to write this article for you guys.</p><p name="5fbd" id="5fbd" class="graf graf--p graf-after--p graf--trailing">I hope you were able to derive some benefit from this article on Breadth First Search and some of its applications. The major focus was to showcase its application to shortest paths in a weighted graph under some constraints 😃.</p></div></div></section>
</section>
</article></body></html>
-->
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2018/06/08/A-deep-dive-into-part-of-speech-tagging-using-the-Viterbi-algorithm-17c8de32e8bc/">
        A deep dive into part-of-speech tagging using the Viterbi algorithm
      </a>
    </h1>

    <span class="post-date">08 Jun 2018</span>
  
    
    <!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>A deep dive into part-of-speech tagging using the Viterbi algorithm</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">A deep dive into part-of-speech tagging using the Viterbi algorithm</h1>
</header>
<section data-field="subtitle" class="p-summary">
by Sachin Malhotra and Divya Godayal
</section>
<section data-field="body" class="e-content">
<section name="fd85" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="74a2" id="74a2" class="graf graf--h3 graf--leading graf--title"></h3><div name="cc82" id="cc82" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">by </em><a href="https://medium.com/@sachinmalhotra" data-href="https://medium.com/@sachinmalhotra" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">Sachin Malhotra</em></a><em class="markup--em markup--p-em"> and </em><a href="https://medium.com/@divyagodayal" data-href="https://medium.com/@divyagodayal" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">Divya Godayal</em></a></div></div><div class="section-inner sectionLayout--fullWidth"><figure name="6d36" id="6d36" class="graf graf--figure graf--layoutFillWidth graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 59.8%;"></div><img class="graf-image" data-image-id="1*x-5ZBtUvlD78BOMuMnMAbg.png" data-width="2894" data-height="1730" data-is-featured="true" src="https://cdn-images-1.medium.com/max/2000/1*x-5ZBtUvlD78BOMuMnMAbg.png"></div><figcaption class="imageCaption">Source: <a href="https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/" data-href="https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="230d" id="230d" class="graf graf--p graf-after--figure">Welcome back, Caretaker!
    <br>
    <a href="/2018/06/08/A-deep-dive-into-part-of-speech-tagging-using-the-Viterbi-algorithm-17c8de32e8bc/">
         Read More...
    </a>
    <hr>
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>A deep dive into part-of-speech tagging using the Viterbi algorithm</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">A deep dive into part-of-speech tagging using the Viterbi algorithm</h1>
</header>
<section data-field="subtitle" class="p-summary">
by Sachin Malhotra and Divya Godayal
</section>
<section data-field="body" class="e-content">
<section name="fd85" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="74a2" id="74a2" class="graf graf--h3 graf--leading graf--title"></h3><div name="cc82" id="cc82" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">by </em><a href="https://medium.com/@sachinmalhotra" data-href="https://medium.com/@sachinmalhotra" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">Sachin Malhotra</em></a><em class="markup--em markup--p-em"> and </em><a href="https://medium.com/@divyagodayal" data-href="https://medium.com/@divyagodayal" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">Divya Godayal</em></a></div></div><div class="section-inner sectionLayout--fullWidth"><figure name="6d36" id="6d36" class="graf graf--figure graf--layoutFillWidth graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 59.8%;"></div><img class="graf-image" data-image-id="1*x-5ZBtUvlD78BOMuMnMAbg.png" data-width="2894" data-height="1730" data-is-featured="true" src="https://cdn-images-1.medium.com/max/2000/1*x-5ZBtUvlD78BOMuMnMAbg.png"></div><figcaption class="imageCaption">Source: <a href="https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/" data-href="https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="230d" id="230d" class="graf graf--p graf-after--figure">Welcome back, Caretaker!  <p name="c33b" id="c33b" class="graf graf--p graf-after--p">In case you’ve forgotten the <a href="https://medium.freecodecamp.org/an-introduction-to-part-of-speech-tagging-and-the-hidden-markov-model-953d45338f24" data-href="https://medium.freecodecamp.org/an-introduction-to-part-of-speech-tagging-and-the-hidden-markov-model-953d45338f24" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">problem</a> we were trying to tackle in the previous article, let us revise it for you.-->
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>A deep dive into part-of-speech tagging using the Viterbi algorithm</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">A deep dive into part-of-speech tagging using the Viterbi algorithm</h1>
</header>
<section data-field="subtitle" class="p-summary">
by Sachin Malhotra and Divya Godayal
</section>
<section data-field="body" class="e-content">
<section name="fd85" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="74a2" id="74a2" class="graf graf--h3 graf--leading graf--title"></h3><div name="cc82" id="cc82" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">by </em><a href="https://medium.com/@sachinmalhotra" data-href="https://medium.com/@sachinmalhotra" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">Sachin Malhotra</em></a><em class="markup--em markup--p-em"> and </em><a href="https://medium.com/@divyagodayal" data-href="https://medium.com/@divyagodayal" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">Divya Godayal</em></a></div></div><div class="section-inner sectionLayout--fullWidth"><figure name="6d36" id="6d36" class="graf graf--figure graf--layoutFillWidth graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 59.8%;"></div><img class="graf-image" data-image-id="1*x-5ZBtUvlD78BOMuMnMAbg.png" data-width="2894" data-height="1730" data-is-featured="true" src="https://cdn-images-1.medium.com/max/2000/1*x-5ZBtUvlD78BOMuMnMAbg.png"></div><figcaption class="imageCaption">Source: <a href="https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/" data-href="https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.vocal.com/echo-cancellation/viterbi-algorithm-in-speech-enhancement-and-hmm/</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="230d" id="230d" class="graf graf--p graf-after--figure">Welcome back, Caretaker!</p><p name="c33b" id="c33b" class="graf graf--p graf-after--p">In case you’ve forgotten the <a href="https://medium.freecodecamp.org/an-introduction-to-part-of-speech-tagging-and-the-hidden-markov-model-953d45338f24" data-href="https://medium.freecodecamp.org/an-introduction-to-part-of-speech-tagging-and-the-hidden-markov-model-953d45338f24" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">problem</a> we were trying to tackle in the previous article, let us revise it for you.</p><p name="921f" id="921f" class="graf graf--p graf-after--p">So there’s this naughty kid Peter and he’s going to pester his new caretaker, you!</p><p name="c485" id="c485" class="graf graf--p graf-after--p">As a caretaker, one of the most important tasks for you is to tuck Peter in bed and make sure he is sound asleep. Once you’ve tucked him in, you want to make sure that he’s actually asleep and not up to some mischief.</p><p name="238d" id="238d" class="graf graf--p graf-after--p">You cannot, however, enter the room again, as that would surely wake Peter up. All you can hear are the noises that might come from the room.</p><p name="b336" id="b336" class="graf graf--p graf-after--p">Either the room is <strong class="markup--strong markup--p-strong">quiet</strong> or there is <strong class="markup--strong markup--p-strong">noise</strong> coming from the room. These are your states.</p><p name="2422" id="2422" class="graf graf--p graf-after--p">All you have as the caretaker are:</p><ul class="postList"><li name="d043" id="d043" class="graf graf--li graf-after--p">a set of observations, which is basically a sequence containing <strong class="markup--strong markup--li-strong">noise<em class="markup--em markup--li-em"> </em></strong>or <strong class="markup--strong markup--li-strong">quiet</strong> over time, and</li><li name="c16c" id="c16c" class="graf graf--li graf-after--li">A state diagram provided by Peter’s mom — who happens to be a neurological scientist — that contains all the different sets of probabilities that you can use to solve the problem defined below.</li></ul><h3 name="5e58" id="5e58" class="graf graf--h3 graf-after--li">The problem</h3><p name="da1b" id="da1b" class="graf graf--p graf-after--h3">Given the state diagram and a sequence of N observations over time, we need to tell the state of the baby at the current point in time. Mathematically, we have N observations over times <code class="markup--code markup--p-code">t0, t1, t2 .... tN</code> . We want to find out if Peter would be awake or asleep, or rather which state is more probable at time <code class="markup--code markup--p-code">tN+1</code> .</p><p name="0d5a" id="0d5a" class="graf graf--p graf-after--p">In case any of this seems like Greek to you, go read the <a href="https://medium.com/@divyagodayal/part-of-speech-tagging-hmms-part-1-953d45338f24" data-href="https://medium.com/@divyagodayal/part-of-speech-tagging-hmms-part-1-953d45338f24" class="markup--anchor markup--p-anchor" target="_blank">previous article</a> to brush up on the Markov Chain Model, Hidden Markov Models, and Part of Speech Tagging.</p><figure name="ea8f" id="ea8f" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 331px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47.3%;"></div><img class="graf-image" data-image-id="0*_i4JqwAZ9DdjO5Kt." data-width="748" data-height="354" src="https://cdn-images-1.medium.com/max/800/0*_i4JqwAZ9DdjO5Kt."></div><figcaption class="imageCaption">The state diagram that Peter’s mom gave you before leaving.</figcaption></figure><p name="ab7f" id="ab7f" class="graf graf--p graf-after--figure">In that <a href="https://medium.com/@divyagodayal/part-of-speech-tagging-hmms-part-1-953d45338f24" data-href="https://medium.com/@divyagodayal/part-of-speech-tagging-hmms-part-1-953d45338f24" class="markup--anchor markup--p-anchor" target="_blank">previous article</a>, we had briefly modeled the problem of Part of Speech tagging using the Hidden Markov Model.</p><p name="031c" id="031c" class="graf graf--p graf-after--p">The problem of Peter being asleep or not is just an example problem taken up for a better understanding of some of the core concepts involved in these two articles. At the core, the articles deal with solving the Part of Speech tagging problem using the Hidden Markov Models.</p><p name="1b34" id="1b34" class="graf graf--p graf-after--p">So, before moving on to the <strong class="markup--strong markup--p-strong">Viterbi Algorithm</strong>, let’s first look at a much more detailed explanation of how the tagging problem can be modeled using HMMs.</p><h3 name="19a7" id="19a7" class="graf graf--h3 graf-after--p">Generative Models and the Noisy Channel Model</h3><p name="55cb" id="55cb" class="graf graf--p graf-after--h3">A lot of problems in Natural Language Processing are solved using a supervised learning approach.</p><p name="0b53" id="0b53" class="graf graf--p graf-after--p">Supervised problems in machine learning are defined as follows. We assume training examples <code class="markup--code markup--p-code">(x(1), y(1))</code>. . .<code class="markup--code markup--p-code">(x(m) , y(m))</code>, where each example consists of an input x(i) paired with a label y(i) . We use X to refer to the set of possible inputs, and Y to refer to the set of possible labels. Our task is to learn a function f : X → Y that maps any input x to a label f(x).</p><p name="cb85" id="cb85" class="graf graf--p graf-after--p">In tagging problems, each x(i) would be a sequence of words <code class="markup--code markup--p-code">X1 X2 X3 …. Xn(i)</code>, and each y(i) would be a sequence of tags <code class="markup--code markup--p-code">Y1 Y2 Y3 … Yn(i)</code>(we use n(i)to refer to the length of the i’th training example). X would refer to the set of all sequences x1 . . . xn, and Y would be the set of all tag sequences y1 . . . yn. Our task would be to learn a function f : X → Y that maps sentences to tag sequences.</p><p name="19dd" id="19dd" class="graf graf--p graf-after--p">An intuitive approach to get an estimate for this problem is to use conditional probabilities. <code class="markup--code markup--p-code">p(y | x)</code> which is the probability of the output y given an input x. The parameters of the model would be estimated using the training samples. Finally, given an unknown input <code class="markup--code markup--p-code">x</code> we would like to find</p><p name="78b5" id="78b5" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">f(x) = arg max(p(y | x)) ∀y ∊ Y</code></p><p name="f448" id="f448" class="graf graf--p graf-after--p">This here is the conditional model to solve this generic problem given the training data. Another approach that is mostly adopted in machine learning and natural language processing is to use a <strong class="markup--strong markup--p-strong">generative model<em class="markup--em markup--p-em">.</em></strong></p><p name="b341" id="b341" class="graf graf--p graf-after--p">Rather than directly estimating the conditional distribution <code class="markup--code markup--p-code">p(y|x)</code>, in generative models we instead model the joint probability <code class="markup--code markup--p-code">p(x, y)</code> over all the (x, y) pairs.</p><p name="3565" id="3565" class="graf graf--p graf-after--p">We can further decompose the joint probability into simpler values using Bayes’ rule:</p><figure name="b560" id="b560" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 158px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 22.6%;"></div><img class="graf-image" data-image-id="1*vqr5JCpC4lkhva03gtTLIg.png" data-width="778" data-height="176" src="https://cdn-images-1.medium.com/max/800/1*vqr5JCpC4lkhva03gtTLIg.png"></div></figure><ul class="postList"><li name="c03e" id="c03e" class="graf graf--li graf-after--figure"><code class="markup--code markup--li-code">p(y)</code> is the prior probability of any input belonging to the label y.</li><li name="9b27" id="9b27" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">p(x | y)</code> is the conditional probability of input x given the label y.</li></ul><p name="7b91" id="7b91" class="graf graf--p graf-after--li">We can use this decomposition and the Bayes rule to determine the conditional probability.</p><figure name="c2ee" id="c2ee" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 205px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.299999999999997%;"></div><img class="graf-image" data-image-id="1*omTbvXw1CsMe6EywVZ9TUg.png" data-width="1002" data-height="294" src="https://cdn-images-1.medium.com/max/800/1*omTbvXw1CsMe6EywVZ9TUg.png"></div></figure><p name="4787" id="4787" class="graf graf--p graf-after--figure">Remember, we wanted to estimate the function</p><pre name="4fb3" id="4fb3" class="graf graf--pre graf-after--p">f(x) = arg max( p(y|x) ) <code class="markup--code markup--pre-code">∀y ∊ Y</code></pre><pre name="94cc" id="94cc" class="graf graf--pre graf-after--pre">f(x) = arg max( p(y) * p(x | y) )</pre><p name="0f0c" id="0f0c" class="graf graf--p graf-after--pre">The reason we skipped the denominator here is because the probability <code class="markup--code markup--p-code">p(x)</code> remains the same no matter what the output label being considered. And so, from a computational perspective, it is treated as a <strong class="markup--strong markup--p-strong">normalization constant and is normally ignored.</strong></p><p name="3731" id="3731" class="graf graf--p graf-after--p">Models that decompose a joint probability into terms <code class="markup--code markup--p-code">p(y)</code> and <code class="markup--code markup--p-code">p(x|y) </code>are often called <strong class="markup--strong markup--p-strong">noisy-channel models</strong>. Intuitively, when we see a test example x, we assume that it has been generated in two steps:</p><ol class="postList"><li name="3398" id="3398" class="graf graf--li graf-after--p">first, a label y has been chosen with probability p(y)</li><li name="9a04" id="9a04" class="graf graf--li graf-after--li">second, the example x has been generated from the distribution p(x|y). The model p(x|y) can be interpreted as a <strong class="markup--strong markup--li-strong">“channel” </strong>which takes a label y as its input, and corrupts it to produce x as its output.</li></ol><h3 name="56be" id="56be" class="graf graf--h3 graf-after--li">Generative Part of Speech Tagging Model</h3><p name="601d" id="601d" class="graf graf--p graf-after--h3">Let us assume a finite set of words V and a finite sequence of tags K. Then the set S will be the set of all sequence, tags pairs <code class="markup--code markup--p-code">&lt;x1, x2, x3 ... xn, y1, y2, y3, ..., yn&gt;</code> such that n &gt; 0 <code class="markup--code markup--p-code">∀x ∊ V</code> and <code class="markup--code markup--p-code">∀y ∊ K</code> .</p><p name="edd4" id="edd4" class="graf graf--p graf-after--p">A generative tagging model is then the one where</p><figure name="c5ef" id="c5ef" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 140px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 20%;"></div><img class="graf-image" data-image-id="1*uYnEH6xCNZN2tumL9gx10Q.png" data-width="1460" data-height="292" src="https://cdn-images-1.medium.com/max/800/1*uYnEH6xCNZN2tumL9gx10Q.png"></div></figure><p name="3f28" id="3f28" class="graf graf--p graf-after--figure">2.</p><figure name="a670" id="a670" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 181px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 25.900000000000002%;"></div><img class="graf-image" data-image-id="1*AO6n9RB0drLb9jbrHPIKDQ.png" data-width="1408" data-height="364" src="https://cdn-images-1.medium.com/max/800/1*AO6n9RB0drLb9jbrHPIKDQ.png"></div></figure><p name="56f5" id="56f5" class="graf graf--p graf-after--figure">Given a generative tagging model, the function that we talked about earlier from input to output becomes</p><figure name="c69e" id="c69e" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 89px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.7%;"></div><img class="graf-image" data-image-id="1*vlACvd9qk5twIw6NORx10A.png" data-width="1554" data-height="198" src="https://cdn-images-1.medium.com/max/800/1*vlACvd9qk5twIw6NORx10A.png"></div></figure><p name="51e2" id="51e2" class="graf graf--p graf-after--figure">Thus for any given input sequence of words, the output is the highest probability tag sequence from the model. Having defined the generative model, we need to figure out three different things:</p><ol class="postList"><li name="42a7" id="42a7" class="graf graf--li graf-after--p">How exactly do we define the generative model probability <code class="markup--code markup--li-code">p(&lt;x1, x2, x3 ... xn, y1, y2, y3, ..., yn&gt;)</code></li><li name="81fe" id="81fe" class="graf graf--li graf-after--li">How do we estimate the parameters of the model, and</li><li name="8979" id="8979" class="graf graf--li graf-after--li">How do we efficiently calculate</li></ol><figure name="fc69" id="fc69" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 89px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.7%;"></div><img class="graf-image" data-image-id="1*vlACvd9qk5twIw6NORx10A.png" data-width="1554" data-height="198" src="https://cdn-images-1.medium.com/max/800/1*vlACvd9qk5twIw6NORx10A.png"></div></figure><p name="b92d" id="b92d" class="graf graf--p graf-after--figure">Let us look at how we can answer these three questions side by side, once for our example problem and then for the actual problem at hand: part of speech tagging.</p><h3 name="e5c2" id="e5c2" class="graf graf--h3 graf-after--p">Defining the Generative Model</h3><p name="8aa0" id="8aa0" class="graf graf--p graf-after--h3">Let us first look at how we can estimate the probability <code class="markup--code markup--p-code">p(x1 .. xn, y1 .. yn)</code> using the HMM.</p><p name="6395" id="6395" class="graf graf--p graf-after--p">We can have any N-gram HMM which considers events in the previous window of size N.</p><p name="4c6e" id="4c6e" class="graf graf--p graf-after--p">The formulas provided hereafter are corresponding to a <strong class="markup--strong markup--p-strong">Trigram </strong>Hidden Markov Model.</p><h4 name="5ebc" id="5ebc" class="graf graf--h4 graf-after--p">Trigram Hidden Markov Model</h4><p name="b6b6" id="b6b6" class="graf graf--p graf-after--h4">A trigram Hidden Markov Model can be defined using</p><ul class="postList"><li name="29ee" id="29ee" class="graf graf--li graf-after--p">A finite set of states.</li><li name="82bd" id="82bd" class="graf graf--li graf-after--li">A sequence of observations.</li><li name="370a" id="370a" class="graf graf--li graf-after--li">q(s|u, v)<br><strong class="markup--strong markup--li-strong">Transition probability</strong> defined as the probability of a state “s” appearing right after observing “u” and “v” in the sequence of observations.</li><li name="03e5" id="03e5" class="graf graf--li graf-after--li">e(x|s)<br><strong class="markup--strong markup--li-strong">Emission probability</strong> defined as the probability of making an observation x given that the state was s.</li></ul><p name="e9a6" id="e9a6" class="graf graf--p graf-after--li">Then, the generative model probability would be estimated as</p><figure name="5ef3" id="5ef3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 98px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 14.000000000000002%;"></div><img class="graf-image" data-image-id="1*T_g39RuOYYway6_mFvp70Q.png" data-width="1998" data-height="280" src="https://cdn-images-1.medium.com/max/800/1*T_g39RuOYYway6_mFvp70Q.png"></div></figure><p name="0583" id="0583" class="graf graf--p graf-after--figure">As for the baby sleeping problem that we are considering, we will have only two possible states: that the baby is either awake or he is asleep. The caretaker can make only two observations over time. Either there is noise coming in from the room or the room is absolutely quiet. The sequence of observations and states can be represented as follows:</p><figure name="0730" id="0730" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 365px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 52.2%;"></div><img class="graf-image" data-image-id="1*BRQINXla9wqwjh8KyIpgOg.png" data-width="1576" data-height="822" src="https://cdn-images-1.medium.com/max/800/1*BRQINXla9wqwjh8KyIpgOg.png"></div><figcaption class="imageCaption">Observations and States over time for the baby sleeping problem</figcaption></figure><p name="4f70" id="4f70" class="graf graf--p graf-after--figure">Coming on to the part of speech tagging problem, the states would be represented by the actual tags assigned to the words. The words would be our observations. The reason we say that the tags are our states is because in a Hidden Markov Model, the states are always hidden and all we have are the set of observations that are visible to us. Along similar lines, the sequence of states and observations for the part of speech tagging problem would be</p><figure name="10ea" id="10ea" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 299px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42.699999999999996%;"></div><img class="graf-image" data-image-id="1*GrNSK8Jtgh2_ABHYS9lbdA.png" data-width="1574" data-height="672" src="https://cdn-images-1.medium.com/max/800/1*GrNSK8Jtgh2_ABHYS9lbdA.png"></div><figcaption class="imageCaption">Observations and States over time for the POS tagging problem</figcaption></figure><h3 name="cad2" id="cad2" class="graf graf--h3 graf-after--figure">Estimating the model’s parameters</h3><p name="9759" id="9759" class="graf graf--p graf-after--h3">We will assume that we have access to some training data. The training data consists of a set of examples where each example is a sequence consisting of the observations, every observation being associated with a state. Given this data, how do we estimate the parameters of the model?</p><p name="2860" id="2860" class="graf graf--p graf-after--p">Estimating the model’s parameters is done by reading various counts off of the training corpus we have, and then computing maximum likelihood estimates:</p><figure name="69ce" id="69ce" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 306px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.7%;"></div><img class="graf-image" data-image-id="1*VgexfYbchSAZJ5fCwQqFOQ.png" data-width="1226" data-height="536" src="https://cdn-images-1.medium.com/max/800/1*VgexfYbchSAZJ5fCwQqFOQ.png"></div><figcaption class="imageCaption">Transition probability and Emission probability for a Trigram HMM</figcaption></figure><p name="26d1" id="26d1" class="graf graf--p graf-after--figure">We already know that the first term represents transition probability and the second term represents the emission probability. Let us look at what the four different counts mean in the terms above.</p><ol class="postList"><li name="0c53" id="0c53" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">c(u, v, s)</strong> represents the trigram count of states u, v and s. Meaning it represents the number of times the three states u, v and s occurred together in that order in the training corpus.</li><li name="c095" id="c095" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">c(u, v)</strong> following along similar lines as that of the trigram count, this is the bigram count of states u and v given the training corpus.</li><li name="9ed4" id="9ed4" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">c(s → x)</strong> is the number of times in the training set that the state s and observation x are paired with each other. And finally,</li><li name="12ef" id="12ef" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">c(s)</strong> is the prior probability of an observation being labelled as the state s.</li></ol><p name="7f73" id="7f73" class="graf graf--p graf-after--li">Let us look at a sample training set for the toy problem first and see the calculations for transition and emission probabilities using the same.</p><p name="c34b" id="c34b" class="graf graf--p graf-after--p">The BLUE markings represent the transition probability, and RED is for emission probability calculations.</p><p name="96e2" id="96e2" class="graf graf--p graf-after--p">Note that since the example problem only has two distinct states and two distinct observations, and given that the training set is very small, the calculations shown below for the example problem are using a <strong class="markup--strong markup--p-strong">bigram<em class="markup--em markup--p-em"> </em></strong>HMM<strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em"> </em></strong>instead of a trigram HMM.</p><p name="a836" id="a836" class="graf graf--p graf-after--p">Peter’s mother was maintaining a record of observations and states. And thus she even provided you with a training corpus to help you get the transition and emission probabilities.</p><h4 name="361a" id="361a" class="graf graf--h4 graf-after--p">Transition Probability Example:</h4><figure name="94f5" id="94f5" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 60px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 8.6%;"></div><img class="graf-image" data-image-id="1*1KKb9HiSws-068YBfWjhgw.png" data-width="1518" data-height="130" src="https://cdn-images-1.medium.com/max/800/1*1KKb9HiSws-068YBfWjhgw.png"></div><figcaption class="imageCaption">Training Corpus</figcaption></figure><figure name="3dc7" id="3dc7" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 336px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 48%;"></div><img class="graf-image" data-image-id="1*VemATVV5YgmBZZZGxjzEQA.png" data-width="1216" data-height="584" src="https://cdn-images-1.medium.com/max/800/1*VemATVV5YgmBZZZGxjzEQA.png"></div><figcaption class="imageCaption">Calculations for Awake appearing after Awake</figcaption></figure><h4 name="dafd" id="dafd" class="graf graf--h4 graf-after--figure">Emission Probability Example:</h4><figure name="6834" id="6834" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 60px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 8.6%;"></div><img class="graf-image" data-image-id="1*aCPlU-ApNX0umWin7U3PBQ.png" data-width="1518" data-height="130" src="https://cdn-images-1.medium.com/max/800/1*aCPlU-ApNX0umWin7U3PBQ.png"></div><figcaption class="imageCaption">Training corpus</figcaption></figure><figure name="2f00" id="2f00" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 298px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 42.6%;"></div><img class="graf-image" data-image-id="1*0umDSsoG676H66LkyHiM_Q.png" data-width="1602" data-height="682" src="https://cdn-images-1.medium.com/max/800/1*0umDSsoG676H66LkyHiM_Q.png"></div><figcaption class="imageCaption">Calculations for observing ‘Quiet’ when the state is ‘Awake’</figcaption></figure><p name="264a" id="264a" class="graf graf--p graf-after--figure">That was quite simple, since the training set was very small. Let us look at a sample training set for our actual problem of part of speech tagging. Here we can consider a trigram HMM, and we will show the calculations accordingly.</p><p name="8b49" id="8b49" class="graf graf--p graf-after--p">We will use the following sentences as a corpus of training data (the notation word/TAG means word tagged with a specific part-of-speech tag).</p><figure name="d335" id="d335" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 479px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.4%;"></div><img class="graf-image" data-image-id="1*E95LGOKw2YVumuZqk_uAJw.png" data-width="1296" data-height="886" src="https://cdn-images-1.medium.com/max/800/1*E95LGOKw2YVumuZqk_uAJw.png"></div></figure><p name="c1f9" id="c1f9" class="graf graf--p graf-after--figure">The training set that we have is a tagged corpus of sentences. Every sentence consists of words tagged with their corresponding part of speech tags. eg:- eat/VB means that the word is “eat” and the part of speech tag in this sentence in this very context is “VB” i.e. Verb Phrase. Let us look at a sample calculation for transition probability and emission probability just like we saw for the baby sleeping problem.</p><h4 name="a01c" id="a01c" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Transition Probability</strong></h4><p name="18ea" id="18ea" class="graf graf--p graf-after--h4">Let’s say we want to calculate the transition probability q(IN | VB, NN). For this, we see how many times we see a trigram (VB,NN,IN) in the training corpus in that specific order. We then divide it by the total number of times we see the bigram (VB,NN) in the corpus.</p><h4 name="12bc" id="12bc" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Emission Probability</strong></h4><p name="1dcb" id="1dcb" class="graf graf--p graf-after--h4">Let’s say we want to find out the emission probability e(an | DT). For this, we see how many times the word “an” is tagged as “DT” in the corpus and divide it by the total number of times we see the tag “DT” in the corpus.</p><figure name="9096" id="9096" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 494px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 70.6%;"></div><img class="graf-image" data-image-id="1*QLaaoZ1WPdWgWsPb7CFoSA.png" data-width="1422" data-height="1004" src="https://cdn-images-1.medium.com/max/800/1*QLaaoZ1WPdWgWsPb7CFoSA.png"></div></figure><p name="d9a6" id="d9a6" class="graf graf--p graf-after--figure">So if you look at these calculations, it shows that calculating the model’s parameters is not computationally expensive. That is, we don’t have to do multiple passes over the training data to calculate these parameters. All we need are a bunch of different counts, and a single pass over the training corpus should provide us with that.</p><p name="c159" id="c159" class="graf graf--p graf-after--p">Let’s move on and look at the final step that we need to look at given a generative model. That step is efficiently calculating</p><figure name="1385" id="1385" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 89px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.7%;"></div><img class="graf-image" data-image-id="1*vlACvd9qk5twIw6NORx10A.png" data-width="1554" data-height="198" src="https://cdn-images-1.medium.com/max/800/1*vlACvd9qk5twIw6NORx10A.png"></div></figure><p name="cbbc" id="cbbc" class="graf graf--p graf-after--figure">We will be looking at the famous Viterbi Algorithm for this calculation.</p><h3 name="fc2a" id="fc2a" class="graf graf--h3 graf-after--p">Finding the most probable sequence — Viterbi Algorithm</h3><p name="e7a7" id="e7a7" class="graf graf--p graf-after--h3">Finally, we are going to solve the problem of finding the most likely sequence of labels given a set of observations x1 … xn. That is, we are to find out</p><figure name="3068" id="3068" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 110px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 15.7%;"></div><img class="graf-image" data-image-id="1*YjdFBbrDymwoCdf_wgfOFA.png" data-width="700" data-height="110" src="https://cdn-images-1.medium.com/max/800/1*YjdFBbrDymwoCdf_wgfOFA.png"></div></figure><p name="9705" id="9705" class="graf graf--p graf-after--figure">The probability here is expressed in terms of the transition and emission probabilities that we learned how to calculate in the previous section of the article. Just to remind you, the formula for the probability of a sequence of labels given a sequence of observations over “n” time steps is</p><figure name="9636" id="9636" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 93px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 13.3%;"></div><img class="graf-image" data-image-id="1*k3LxXJs2vmw5YT1dGlvMLw.png" data-width="1160" data-height="154" src="https://cdn-images-1.medium.com/max/800/1*k3LxXJs2vmw5YT1dGlvMLw.png"></div></figure><p name="65da" id="65da" class="graf graf--p graf-after--figure">Before looking at an optimized algorithm to solve this problem, let us first look at a simple brute force approach to this problem. Basically, we need to find out the most probable label sequence given a set of observations out of a finite set of possible sequences of labels. Let’s look at the total possible number of sequences for a small example for our example problem and also for a part of speech tagging problem.</p><p name="1480" id="1480" class="graf graf--p graf-after--p">Say we have the following set of observations for the example problem.</p><pre name="ce00" id="ce00" class="graf graf--pre graf-after--p">Noise     Quiet     Noise</pre><p name="9608" id="9608" class="graf graf--p graf-after--pre">We have two possible labels {Asleep and Awake}. Some of the possible sequence of labels for the observations above are:</p><pre name="1866" id="1866" class="graf graf--pre graf-after--p">Awake      Awake     Awake</pre><pre name="f50f" id="f50f" class="graf graf--pre graf-after--pre">Awake      Awake     Asleep</pre><pre name="32c4" id="32c4" class="graf graf--pre graf-after--pre">Awake      Asleep    Awake</pre><pre name="580f" id="580f" class="graf graf--pre graf-after--pre">Awake      Asleep    Asleep</pre><p name="bacd" id="bacd" class="graf graf--p graf-after--pre">In all we can have ²³ = 8 possible sequences. This might not seem like very many, but if we increase the number of observations over time, the number of sequences would increase exponentially. This is the case when we only had two possible labels. What if we have more? As is the case with part of speech tagging.</p><p name="a3b5" id="a3b5" class="graf graf--p graf-after--p">For example, consider the sentence</p><pre name="bf95" id="bf95" class="graf graf--pre graf-after--p">the dog barks</pre><p name="a6c4" id="a6c4" class="graf graf--p graf-after--pre">and assuming that the set of possible tags are {D, N, V}, let us look at some of the possible tag sequences:</p><pre name="f977" id="f977" class="graf graf--pre graf-after--p">D     D     D<br>D     D     N<br>D     D     V<br>D     N     D<br>D     N     N<br>D     N     V ... etc</pre><p name="c800" id="c800" class="graf graf--p graf-after--pre">Here, we would have ³³ = 27 possible tag sequences. And as you can see, the sentence was extremely short and the number of tags weren’t very many. In practice, we can have sentences that might be much larger than just three words. Then the number of unique labels at our disposal would also be too high to follow this enumeration approach and find the best possible tag sequence this way.</p><p name="d340" id="d340" class="graf graf--p graf-after--p">So the exponential growth in the number of sequences implies that for any reasonable length sentence, the brute force approach would not work out as it would take too much time to execute.</p><p name="08d9" id="08d9" class="graf graf--p graf-after--p">Instead of this brute force approach, we will see that we can find the highest probable tag sequence efficiently using a dynamic programming algorithm known as the <strong class="markup--strong markup--p-strong">Viterbi Algorithm.</strong></p><p name="c823" id="c823" class="graf graf--p graf-after--p">Let us first define some terms that would be useful in defining the algorithm itself. We already know that the probability of a label sequence given a set of observations can be defined in terms of the transition probability and the emission probability. Mathematically, it is</p><figure name="8a48" id="8a48" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 91px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 13%;"></div><img class="graf-image" data-image-id="1*JIqZ2wCdNB4FeTgd1Uz6yw.png" data-width="1142" data-height="148" src="https://cdn-images-1.medium.com/max/800/1*JIqZ2wCdNB4FeTgd1Uz6yw.png"></div></figure><p name="5327" id="5327" class="graf graf--p graf-after--figure">Let us look at a truncated version of this which is</p><figure name="3864" id="3864" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 113px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 16.2%;"></div><img class="graf-image" data-image-id="1*i8qSInkAqmK9deXrLTKw8g.png" data-width="928" data-height="150" src="https://cdn-images-1.medium.com/max/800/1*i8qSInkAqmK9deXrLTKw8g.png"></div></figure><p name="89ac" id="89ac" class="graf graf--p graf-after--figure">and let us call this the cost of a sequence of length k.</p><p name="3787" id="3787" class="graf graf--p graf-after--p">So the definition of “r” is simply considering the first k terms off of the definition of probability where k ∊ {1..n} and for any label sequence y1…yk.</p><p name="8af1" id="8af1" class="graf graf--p graf-after--p">Next we have the set S(k, u, v) which is basically the set of all label sequences of length k that end with the bigram (u, v) i.e.</p><figure name="e4c9" id="e4c9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 43px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 6.1%;"></div><img class="graf-image" data-image-id="1*VnH7pFyjnoBLPMc34RWD7Q.png" data-width="1010" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*VnH7pFyjnoBLPMc34RWD7Q.png"></div></figure><p name="b841" id="b841" class="graf graf--p graf-after--figure">Finally, we define the term π(k, u, v) which is basically the sequence with the maximum cost.</p><figure name="68a0" id="68a0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 100px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 14.299999999999999%;"></div><img class="graf-image" data-image-id="1*Mq4QjRUI5lVkVBdVjzDcGQ.png" data-width="810" data-height="116" src="https://cdn-images-1.medium.com/max/800/1*Mq4QjRUI5lVkVBdVjzDcGQ.png"></div></figure><p name="412c" id="412c" class="graf graf--p graf-after--figure">The main idea behind the Viterbi Algorithm is that we can calculate the values of the term π(k, u, v) efficiently in a recursive, memoized fashion. In order to define the algorithm recursively, let us look at the base cases for the recursion.</p><pre name="2a54" id="2a54" class="graf graf--pre graf-after--p">π(0, *, *) = 1</pre><pre name="0f7d" id="0f7d" class="graf graf--pre graf-after--pre">π(0, u, v) = 0</pre><p name="5145" id="5145" class="graf graf--p graf-after--pre">Since we are considering a trigram HMM, we would be considering all of the trigrams as a part of the execution of the Viterbi Algorithm.</p><p name="309c" id="309c" class="graf graf--p graf-after--p">Now, we can start the first trigram window from the first three words of the sentence but then the model would miss out on those trigrams where the first word or the first two words occurred independently. For that reason, we consider two special start symbols as <code class="markup--code markup--p-code">*</code> and so our sentence becomes</p><pre name="3d6a" id="3d6a" class="graf graf--pre graf-after--p">*    *    x1   x2   x3   ......         xn</pre><p name="f009" id="f009" class="graf graf--p graf-after--pre">And the first trigram we consider then would be (*, *, x1) and the second one would be (*, x1, x2).</p><p name="d26c" id="d26c" class="graf graf--p graf-after--p">Now that we have all our terms in place, we can finally look at the recursive definition of the algorithm which is basically the heart of the algorithm.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="81ec" id="81ec" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 514px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 51.4%;"></div><img class="graf-image" data-image-id="1*OcNkv1g-V0s_YZR76D79sw.png" data-width="2224" data-height="1144" src="https://cdn-images-1.medium.com/max/1000/1*OcNkv1g-V0s_YZR76D79sw.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="460f" id="460f" class="graf graf--p graf-after--figure">This definition is clearly recursive, because we are trying to calculate one π term and we are using another one with a lower value of k in the recurrence relation for it.</p><figure name="f4bd" id="f4bd" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 55px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 7.8%;"></div><img class="graf-image" data-image-id="1*_AbNeEabGTVYBq4VbnbAQg.png" data-width="1766" data-height="138" src="https://cdn-images-1.medium.com/max/800/1*_AbNeEabGTVYBq4VbnbAQg.png"></div></figure><p name="5999" id="5999" class="graf graf--p graf-after--figure">Every sequence would end with a special STOP symbol. For the trigram model, we would also have two special start symbols “*” in the beginning.</p><p name="edf6" id="edf6" class="graf graf--p graf-after--p">Have a look at the pseudo-code for the entire algorithm.</p><figure name="2f93" id="2f93" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 330px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47.199999999999996%;"></div><img class="graf-image" data-image-id="1*Vex29pOqTVPdtc7Wdz9tlw.png" data-width="1852" data-height="874" src="https://cdn-images-1.medium.com/max/800/1*Vex29pOqTVPdtc7Wdz9tlw.png"></div></figure><p name="d500" id="d500" class="graf graf--p graf-after--figure">The algorithm first fills in the π(k, u, v) values in using the recursive<br>definition. It then uses the identity described before to calculate the highest probability for any sequence.</p><p name="3362" id="3362" class="graf graf--p graf-after--p">The running time for the algorithm is O(n|K|³), hence it is linear in the length of the sequence, and cubic in the number of tags.</p><p name="91d7" id="91d7" class="graf graf--p graf-after--p">NOTE: We would be showing calculations for the baby sleeping problem and the part of speech tagging problem based off a <strong class="markup--strong markup--p-strong">bigram HMM only. </strong>The calculations for the trigram are left to the reader to do themselves. But the code that is attached at the end of this article is based on a trigram HMM. It’s just that the calculations are easier to explain and portray for the Viterbi algorithm when considering a bigram HMM instead of a trigram HMM.</p><p name="d00f" id="d00f" class="graf graf--p graf-after--p">Therefore, before showing the calculations for the Viterbi Algorithm, let us look at the recursive formula based on a bigram HMM.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="636c" id="636c" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 721px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 72.1%;"></div><img class="graf-image" data-image-id="1*XmRwVbO0yHq8bsXO7jgCGA.png" data-width="1996" data-height="1440" src="https://cdn-images-1.medium.com/max/1000/1*XmRwVbO0yHq8bsXO7jgCGA.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="21bd" id="21bd" class="graf graf--p graf-after--figure">This one is extremely similar to the one we saw before for the trigram model, except that now we are only concerning ourselves with the current label and the one before, instead of two before. The complexity of the algorithm now becomes O(n|K|²).</p><h4 name="aa4f" id="aa4f" class="graf graf--h4 graf-after--p">Calculations for Baby Sleeping Problem</h4><p name="5604" id="5604" class="graf graf--p graf-after--h4">Now that we have the recursive formula ready for the Viterbi Algorithm, let us see a sample calculation of the same firstly for the example problem that we had, that is, the baby sleeping problem, and then for the part of speech tagging version.</p><p name="e3ba" id="e3ba" class="graf graf--p graf-after--p">Note that when we are at this step, that is, the calculations for the Viterbi Algorithm to find the most likely tag sequence given a set of observations over a series of time steps, we assume that transition and emission probabilities have already been calculated from the given corpus. Let’s have a look at a sample of transition and emission probabilities for the baby sleeping problem that we would use for our calculations of the algorithm.</p><figure name="ab6a" id="ab6a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 314px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 44.800000000000004%;"></div><img class="graf-image" data-image-id="1*I8XENfbYguOXxWgeHwFKJw.png" data-width="1076" data-height="482" src="https://cdn-images-1.medium.com/max/800/1*I8XENfbYguOXxWgeHwFKJw.png"></div></figure><p name="a8dc" id="a8dc" class="graf graf--p graf-after--figure">The baby starts by being awake, and remains in the room for three time points, t1 . . . t3 (three iterations of the Markov chain). The observations are: quiet, quiet, noise. Have a look at the following diagram that shows the calculations for up to two time-steps. The complete diagram with all the final set of values will be shown afterwards.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="76f1" id="76f1" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 827px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 82.69999999999999%;"></div><img class="graf-image" data-image-id="1*65f7qx2216umw5c4J-EByA.png" data-width="1588" data-height="1314" src="https://cdn-images-1.medium.com/max/1000/1*65f7qx2216umw5c4J-EByA.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="d0d1" id="d0d1" class="graf graf--p graf-after--figure">We have not shown the calculations for the state of “asleep” at k = 2 and the calculations for k = 3 in the above diagram to keep things simple.</p><p name="1d62" id="1d62" class="graf graf--p graf-after--p">Now that we have all these calculations in place, we want to calculate the most likely sequence of states that the baby can be in over the different given time steps. So, for k = 2 and the state of Awake, we want to know the most likely state at k = 1 that transitioned to Awake at k = 2. (k = 2 represents a sequence of states of length 3 starting off from 0 and t = 2 would mean the state at time-step 2. We are given the state at t = 0 i.e. Awake).</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="643a" id="643a" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 782px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 78.2%;"></div><img class="graf-image" data-image-id="1*Qs1Y0xm5aQDKWTO_783qCA.png" data-width="1780" data-height="1392" src="https://cdn-images-1.medium.com/max/1000/1*Qs1Y0xm5aQDKWTO_783qCA.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="0706" id="0706" class="graf graf--p graf-after--figure">Clearly, if the state at time-step 2 was AWAKE, then the state at time-step 1 would have been AWAKE as well, as the calculations point out. So, the Viterbi Algorithm not only helps us find the π(k) values, that is the cost values for all the sequences using the concept of dynamic programming, but it also helps us to find the most likely tag sequence given a start state and a sequence of observations. The algorithm, along with the pseudo-code for storing the <strong class="markup--strong markup--p-strong">back-pointers<em class="markup--em markup--p-em"> </em></strong>is given below.</p><figure name="15a0" id="15a0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 523px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 74.7%;"></div><img class="graf-image" data-image-id="1*FJkk8r9KxAZsOZXzFznnzQ.png" data-width="1082" data-height="808" src="https://cdn-images-1.medium.com/max/800/1*FJkk8r9KxAZsOZXzFznnzQ.png"></div></figure><h4 name="dda8" id="dda8" class="graf graf--h4 graf-after--figure">Calculations for the Part of Speech Tagging Problem</h4><p name="2052" id="2052" class="graf graf--p graf-after--h4">Let us look at a slightly bigger corpus for the part of speech tagging and the corresponding Viterbi graph showing the calculations and back-pointers for the Viterbi Algorithm.</p><p name="e355" id="e355" class="graf graf--p graf-after--p">Here is the corpus that we will consider:</p><figure name="b75b" id="b75b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 412px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 58.8%;"></div><img class="graf-image" data-image-id="1*Kk1RzSbVGDW4aJ8zmiSliA.png" data-width="938" data-height="552" src="https://cdn-images-1.medium.com/max/800/1*Kk1RzSbVGDW4aJ8zmiSliA.png"></div></figure><p name="f10a" id="f10a" class="graf graf--p graf-after--figure">Now take a look at the transition probabilities calculated from this corpus.</p><figure name="2bac" id="2bac" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 682px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 97.39999999999999%;"></div><img class="graf-image" data-image-id="1*PIMy_sW7sMz7RXgewMgrkA.png" data-width="1366" data-height="1330" src="https://cdn-images-1.medium.com/max/800/1*PIMy_sW7sMz7RXgewMgrkA.png"></div></figure><p name="a08f" id="a08f" class="graf graf--p graf-after--figure">Here, q0 → VB represents the probability of a sentence starting off with the tag VB, that is the first word of a sentence being tagged as VB. Similarly, q0 → NN represents the probability of a sentence starting with the tag NN. Notice that out of 10 sentences in the corpus, 8 start with NN and 2 with VB and hence the corresponding transition probabilities.</p><p name="d906" id="d906" class="graf graf--p graf-after--p">As for the emission probabilities, ideally we should be looking at all the combinations of tags and words in the corpus. Since that would be too much, we will only consider emission probabilities for the sentence that would be used in the calculations for the Viterbi Algorithm.</p><pre name="c38f" id="c38f" class="graf graf--pre graf-after--p">Time flies like an arrow</pre><p name="59ea" id="59ea" class="graf graf--p graf-after--pre">The emission probabilities for the sentence above are:</p><figure name="59ae" id="59ae" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 184px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 26.3%;"></div><img class="graf-image" data-image-id="1*QeTkU4PaCo4yon8LfBbtDg.png" data-width="1590" data-height="418" src="https://cdn-images-1.medium.com/max/800/1*QeTkU4PaCo4yon8LfBbtDg.png"></div></figure><p name="083e" id="083e" class="graf graf--p graf-after--figure">Finally, we are ready to see the calculations for the given sentence, transition probabilities, emission probabilities, and the given corpus.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="9646" id="9646" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 501px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 50.1%;"></div><img class="graf-image" data-image-id="1*rpRFFEmVLE1PBUc4OwpWgg.png" data-width="1990" data-height="996" src="https://cdn-images-1.medium.com/max/1000/1*rpRFFEmVLE1PBUc4OwpWgg.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="c32d" id="c32d" class="graf graf--p graf-after--figure">So, is that all there is to the Viterbi Algorithm ?</p><p name="6c6a" id="6c6a" class="graf graf--p graf-after--p">Take a look at the example below.</p><p name="1738" id="1738" class="graf graf--p graf-after--p">The bucket below each word is filled with the possible tags seen next to the word in the training corpus. The given sentence can have the combinations of tags depending on which path we take. But there is a catch. Can you figure out what that is?</p><figure name="f550" id="f550" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 287px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41%;"></div><img class="graf-image" data-image-id="1*7DVGrmTkEW7wS2DxrS0B5g.png" data-width="2590" data-height="1062" src="https://cdn-images-1.medium.com/max/800/1*7DVGrmTkEW7wS2DxrS0B5g.png"></div><figcaption class="imageCaption">All combinations of sequence paths</figcaption></figure><p name="6573" id="6573" class="graf graf--p graf-after--figure">Were you able to figure it out?</p><p name="7fb6" id="7fb6" class="graf graf--p graf-after--p">No??</p><p name="e511" id="e511" class="graf graf--p graf-after--p">Let me tell you what it is.</p><p name="edee" id="edee" class="graf graf--p graf-after--p">There might be some path in the computation graph for which we do not have a transition probability. So our algorithm can just discard that path and take the other path.</p><figure name="eca8" id="eca8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 266px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 38%;"></div><img class="graf-image" data-image-id="1*lXoyPV31HXNROE8wrvk_PQ.png" data-width="1562" data-height="594" src="https://cdn-images-1.medium.com/max/800/1*lXoyPV31HXNROE8wrvk_PQ.png"></div></figure><p name="aa68" id="aa68" class="graf graf--p graf-after--figure">In the above diagram, we discard the path marked in red since we do not have q(VB|VB). The training corpus never has a <strong class="markup--strong markup--p-strong">VB</strong> followed by <strong class="markup--strong markup--p-strong">VB</strong>. So in the Viterbi calculations, we end up taking q(VB|VB) = 0. And if you’ve been following the algorithm along closely, you would find that a single 0 in the calculations would make the entire probability or the maximum cost for a sequence of tags / labels to be 0.</p><p name="4874" id="4874" class="graf graf--p graf-after--p">This however means that we are ignoring the combinations which are not seen in the training corpus.</p><p name="cb69" id="cb69" class="graf graf--p graf-after--p">Is that the right way to approach the real world examples?</p><p name="8680" id="8680" class="graf graf--p graf-after--p">Consider a small tweak in the above sentence.</p><figure name="d621" id="d621" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 292px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.8%;"></div><img class="graf-image" data-image-id="1*_WJT4hUD6VIbDwwaeC0bYA.png" data-width="2620" data-height="1094" src="https://cdn-images-1.medium.com/max/800/1*_WJT4hUD6VIbDwwaeC0bYA.png"></div><figcaption class="imageCaption">Time flies like <strong class="markup--strong markup--figure-strong">take</strong> arrow</figcaption></figure><p name="066c" id="066c" class="graf graf--p graf-after--figure">In this sentence we do not have any alternative path. Even if we have Viterbi probability until we reach the word “like”, we cannot proceed further. Since both q(VB|VB) = 0 and q(VB|IN) = 0. What do we do now?</p><p name="232d" id="232d" class="graf graf--p graf-after--p">The corpus that we considered here was very small. Consider any reasonably sized corpus with a lot of words and we have a major problem of sparsity of data. Take a look below.</p><figure name="fc2b" id="fc2b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 593px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 84.7%;"></div><img class="graf-image" data-image-id="1*TbMxaow_H3ZUbkHuSorhqQ.png" data-width="1084" data-height="918" src="https://cdn-images-1.medium.com/max/800/1*TbMxaow_H3ZUbkHuSorhqQ.png"></div><figcaption class="imageCaption">Source: <a href="http://www.cs.pomona.edu/~kim/CSC181S08/lectures/Lec6/Lec6.pdf" data-href="http://www.cs.pomona.edu/~kim/CSC181S08/lectures/Lec6/Lec6.pdf" class="markup--anchor markup--figure-anchor" rel="nofollow noopener noopener" target="_blank">http://www.cs.pomona.edu/~kim/CSC181S08/lectures/Lec6/Lec6.pdf</a></figcaption></figure><p name="b900" id="b900" class="graf graf--p graf-after--figure">That means that we can have a potential 68 billion bigrams but the number of words in the corpus are just under a billion. That is a huge number of zero transition probabilities to fill up. The problem of sparsity of data is even more elaborate in case we are considering trigrams.</p><p name="ce9e" id="ce9e" class="graf graf--p graf-after--p">To solve this problem of data sparsity, we resort to a solution called Smoothing.</p><h3 name="383d" id="383d" class="graf graf--h3 graf-after--p">Smoothing</h3><p name="a514" id="a514" class="graf graf--p graf-after--h3">The idea behind Smoothing is just this:</p><ol class="postList"><li name="b3a4" id="b3a4" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Discount </strong>— the existing probability values somewhat and</li><li name="6ea4" id="6ea4" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Reallocate </strong>— this probability to the zeroes</li></ol><p name="91a8" id="91a8" class="graf graf--p graf-after--li">In this way, we redistribute the non zero probability values to compensate for the unseen transition combinations. Let us consider a very simple type of smoothing technique known as Laplace Smoothing.</p><p name="4fa7" id="4fa7" class="graf graf--p graf-after--p">Laplace smoothing is also known as one count smoothing. You will understand exactly why it goes by that name in a moment. Let’s revise how the parameters for a trigram HMM model are calculated given a training corpus.</p><figure name="38b4" id="38b4" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 473px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 67.60000000000001%;"></div><img class="graf-image" data-image-id="1*xQpIu7eeclDRbdxM-mcAiA.png" data-width="1352" data-height="914" src="https://cdn-images-1.medium.com/max/800/1*xQpIu7eeclDRbdxM-mcAiA.png"></div></figure><p name="37fa" id="37fa" class="graf graf--p graf-after--figure">The possible values that can go wrong here are</p><ol class="postList"><li name="b5d6" id="b5d6" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">c(u, v, s)</code> is 0</li><li name="6dd7" id="6dd7" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">c(u, v)</code> is 0</li><li name="ff51" id="ff51" class="graf graf--li graf-after--li">We get an unknown word in the test sentence, and we don’t have any training tags associated with it.</li></ol><p name="2695" id="2695" class="graf graf--p graf-after--li">All these can be solved via smoothing. So the Laplace smoothing counts would become</p><figure name="d068" id="d068" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 423px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 60.5%;"></div><img class="graf-image" data-image-id="1*H8f_RnB22MxVlIjr_edSJg.png" data-width="1432" data-height="866" src="https://cdn-images-1.medium.com/max/800/1*H8f_RnB22MxVlIjr_edSJg.png"></div></figure><p name="d7db" id="d7db" class="graf graf--p graf-after--figure">Here V is the total number of tags in our corpus and λ is basically a real value between 0 and 1. It acts like a discounting factor. A λ = 1 value would give us <strong class="markup--strong markup--p-strong">too much of a redistribution of values of probabilities. </strong>For example:</p><figure name="d503" id="d503" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 282px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40.300000000000004%;"></div><img class="graf-image" data-image-id="1*YRPm8NS-Fk5d6MB_3VHsqg.png" data-width="1166" data-height="470" src="https://cdn-images-1.medium.com/max/800/1*YRPm8NS-Fk5d6MB_3VHsqg.png"></div></figure><p name="669b" id="669b" class="graf graf--p graf-after--figure">Too much of a weight is given to unseen trigrams for λ = 1 and that is why the above mentioned modified version of Laplace Smoothing is considered for all practical applications. The value of the discounting factor is to be varied from one application to another.</p><p name="17df" id="17df" class="graf graf--p graf-after--p">Note that λ = 1 would only create a problem if the vocabulary size is too large. For a smaller corpus, λ = 1 would give us a good performance to start off with.</p><p name="3f0e" id="3f0e" class="graf graf--p graf-after--p">A thing to note about Laplace Smoothing is that it is a uniform redistribution, that is, all the trigrams that were previously unseen would have equal probabilities. So, suppose we are given some data and we observe that</p><ul class="postList"><li name="a1d1" id="a1d1" class="graf graf--li graf-after--p">Frequency of trigram &lt;gave, the, thing&gt; is zero</li><li name="ecb2" id="ecb2" class="graf graf--li graf-after--li">Frequency of trigram &lt;gave, the, think&gt; is also zero</li><li name="f240" id="f240" class="graf graf--li graf-after--li">Uniform distribution over unseen events means: <br>P(thing|gave, the) = P(think|gave, the)</li></ul><p name="6c6b" id="6c6b" class="graf graf--p graf-after--li">Does that reflect our knowledge about English use?<br>P(thing|gave, the) &gt; P(think|gave, the) ideally, but uniform distribution using Laplace smoothing will not consider this.</p><p name="bf16" id="bf16" class="graf graf--p graf-after--p">This means that millions of unseen trigrams in a huge corpus would have equal probabilities when they are being considered in our calculations. That is probably not the right thing to do. However, it is better than to consider the 0 probabilities which would lead to these trigrams and eventually some paths in the Viterbi graph getting completely ignored. But this still needs to be worked upon and made better.</p><p name="1e8d" id="1e8d" class="graf graf--p graf-after--p">There are, however, a lot of different types of smoothing techniques that improve upon the basic Laplace Smoothing technique and help overcome this problem of uniform distribution of probabilities. Some of these techniques are:</p><ul class="postList"><li name="f121" id="f121" class="graf graf--li graf-after--p">Good-Turing estimate</li><li name="63ce" id="63ce" class="graf graf--li graf-after--li">Jelinek-Mercer smoothing (interpolation)</li><li name="ab88" id="ab88" class="graf graf--li graf-after--li">Katz smoothing (backoff)</li><li name="e300" id="e300" class="graf graf--li graf-after--li">Witten-Bell smoothing</li><li name="c00a" id="c00a" class="graf graf--li graf-after--li">Absolute discounting</li><li name="0b2c" id="0b2c" class="graf graf--li graf-after--li">Kneser-Ney smoothing</li></ul><p name="15a9" id="15a9" class="graf graf--p graf-after--li">To read more on these different types of smoothing techniques in more detail, refer to <a href="https://nlp.stanford.edu/~wcmac/papers/20050421-smoothing-tutorial.pdf" data-href="https://nlp.stanford.edu/~wcmac/papers/20050421-smoothing-tutorial.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">this</a> tutorial. Which smoothing technique to choose highly depends upon the type of application at hand, the type of data being considered, and also on the size of the data set.</p><p name="538c" id="538c" class="graf graf--p graf-after--p">If you have been following along this lengthy article, then I must say</p><figure name="97f2" id="97f2" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 906px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 129.4%;"></div><img class="graf-image" data-image-id="1*R1pwNm3-Ju-9E4LdvYak1A.jpeg" data-width="900" data-height="1165" src="https://cdn-images-1.medium.com/max/800/1*R1pwNm3-Ju-9E4LdvYak1A.jpeg"></div><figcaption class="imageCaption">Source: <a href="https://sebreg.deviantart.com/art/You-re-Kind-of-Awesome-289166787" data-href="https://sebreg.deviantart.com/art/You-re-Kind-of-Awesome-289166787" class="markup--anchor markup--figure-anchor" rel="nofollow noopener noopener" target="_blank">https://sebreg.deviantart.com/art/You-re-Kind-of-Awesome-289166787</a></figcaption></figure><p name="5ced" id="5ced" class="graf graf--p graf-after--figure">Let’s move on and look at a slight optimization that we can do to the Viterbi algorithm that can reduce the number of computations and that also makes sense for a lot of data sets out there.</p><p name="d97d" id="d97d" class="graf graf--p graf-after--p">Before that, however, look at the pseudo-code for the algorithm once again.</p><figure name="a057" id="a057" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 330px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47.199999999999996%;"></div><img class="graf-image" data-image-id="1*Vex29pOqTVPdtc7Wdz9tlw.png" data-width="1852" data-height="874" src="https://cdn-images-1.medium.com/max/800/1*Vex29pOqTVPdtc7Wdz9tlw.png"></div></figure><p name="8d29" id="8d29" class="graf graf--p graf-after--figure">If we look closely, we can see that <strong class="markup--strong markup--p-strong">for every trigram of words, we are considering all possible set of tags. </strong>That is, if the number of tags are V, then we are considering |V|³ number of combinations for every trigram of the test sentence.</p><p name="ce1f" id="ce1f" class="graf graf--p graf-after--p">Ignore the trigram for now and just consider a single word. We would be considering all of the unique tags for a given word in the above mentioned algorithm. Consider a corpus where we have the word “kick” which is associated with only two tags, say {NN, VB} and the total number of unique tags in the training corpus are around 500 (it’s a huge corpus).</p><figure name="01c6" id="01c6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 601px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 85.9%;"></div><img class="graf-image" data-image-id="1*P1fkUUTMSTgBneCNqV4sgw.png" data-width="1654" data-height="1420" src="https://cdn-images-1.medium.com/max/800/1*P1fkUUTMSTgBneCNqV4sgw.png"></div></figure><p name="c4f4" id="c4f4" class="graf graf--p graf-after--figure">Now the problem here is apparent. We might end up assigning a tag that doesn’t make sense with the word under consideration, simply because the transition probability of the trigram ending at the tag was very high, like in the example shown above. Also, it would be computationally inefficient to consider all 500 tags for the word “kick” if it only ever occurs with two unique tags in the entire corpus.</p><p name="9f5e" id="9f5e" class="graf graf--p graf-after--p">So, the optimization we do is that for every word, instead of considering all the unique tags in the corpus, <strong class="markup--strong markup--p-strong">we just consider the tags that it occurred with in the corpus</strong>.</p><p name="c3bf" id="c3bf" class="graf graf--p graf-after--p">This would work because, for a reasonably large corpus, a given word would ideally occur with all the various set of tags with which it can occur (most of them at-least). Then it would be reasonable to simply consider just those tags for the Viterbi algorithm.</p><p name="9466" id="9466" class="graf graf--p graf-after--p">As far as the Viterbi decoding algorithm is concerned, the complexity still remains the same because we are always concerned with the worst case complexity. In the worst case, every word occurs with every unique tag in the corpus, and so the complexity remains at O(n|V|³) for the trigram model and O(n|V|²) for the bigram model.</p><p name="bd23" id="bd23" class="graf graf--p graf-after--p">For the recursive implementation of the code, please refer to</p><div name="a7d2" id="a7d2" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/DivyaGodayal/HMM-POS-Tagger" data-href="https://github.com/DivyaGodayal/HMM-POS-Tagger" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/DivyaGodayal/HMM-POS-Tagger"><strong class="markup--strong markup--mixtapeEmbed-strong">DivyaGodayal/HMM-POS-Tagger</strong><br><em class="markup--em markup--mixtapeEmbed-em">HMM-POS-Tagger — An HMM based Part of Speech Tagger implementation using Laplace Smoothing and Trigram HMMs</em>github.com</a><a href="https://github.com/DivyaGodayal/HMM-POS-Tagger" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6eae171144a70b8b97d1899f9d7c65ec" data-thumbnail-img-id="0*5agih_ZSjxgNTkve." style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*5agih_ZSjxgNTkve.);"></a></div><p name="13ad" id="13ad" class="graf graf--p graf-after--mixtapeEmbed">The recursive implementation is done along with Laplace Smoothing.</p><p name="8c6c" id="8c6c" class="graf graf--p graf-after--p">For the iterative implementation, refer to</p><div name="1154" id="1154" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/edorado93/HMM-Part-of-Speech-Tagger" data-href="https://github.com/edorado93/HMM-Part-of-Speech-Tagger" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/edorado93/HMM-Part-of-Speech-Tagger"><strong class="markup--strong markup--mixtapeEmbed-strong">edorado93/HMM-Part-of-Speech-Tagger</strong><br><em class="markup--em markup--mixtapeEmbed-em">HMM-Part-of-Speech-Tagger — An HMM based Part of Speech Tagger</em>github.com</a><a href="https://github.com/edorado93/HMM-Part-of-Speech-Tagger" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="067b589fcee6fada5537444c30b62ca1" data-thumbnail-img-id="0*trBIckExX_4bdurZ." style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*trBIckExX_4bdurZ.);"></a></div><p name="cba1" id="cba1" class="graf graf--p graf-after--mixtapeEmbed">This implementation is done with One-Count Smoothing technique which leads to better accuracy as compared to the Laplace Smoothing.</p><p name="80d4" id="80d4" class="graf graf--p graf-after--p">A lot of snapshots of formulas and calculations in the two articles are derived from <a href="http://1.%20http://www.cs.columbia.edu/~mcollins/courses/nlp2011/notes/hmms.pdf" data-href="http://1. http://www.cs.columbia.edu/~mcollins/courses/nlp2011/notes/hmms.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><p name="5851" id="5851" class="graf graf--p graf-after--p graf--trailing">Do let us know how this blog post helped you, and point out the mistakes if you find some while reading the article in the comments section below. Also, please recommend (by clapping) and spread the love as much as possible for this post if you think this might be useful for someone.</p></div></div></section>
</section>
</article></body></html>-->
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2018/06/01/Change-the-signs-how-to-use-dynamic-programming-to-solve-a-competitive-programming-question-f9730e8f04a9/">
        Change the signs: how to use dynamic programming to solve a competitive programming question
      </a>
    </h1>

    <span class="post-date">01 Jun 2018</span>
  
    
    <!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Change the signs: how to use dynamic programming to solve a competitive programming question</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Change the signs: how to use dynamic programming to solve a competitive programming question</h1>
</header>
<section data-field="subtitle" class="p-summary">
If you’re a competitive programmer like I am, one of the best feelings in the world is seeing your program getting accepted on first try on…
</section>
<section data-field="body" class="e-content">
<section name="b4c0" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3e6d" id="3e6d" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="8d9d" id="8d9d" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 78.4%;"></div><img class="graf-image" data-image-id="1*kdC2W2WKEjPIG1pRCk0qmg.png" data-width="2046" data-height="1604" data-is-featured="true" src="https://cdn-images-1.medium.com/max/2000/1*kdC2W2WKEjPIG1pRCk0qmg.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="2645" id="2645" class="graf graf--p graf-after--figure">If you’re a competitive programmer like I am, one of the best feelings in the world is seeing your program getting accepted on first try on one of the most famous programming platforms, <a href="https://www.codechef.com/" data-href="https://www.codechef.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CodeChef</a>.
    <br>
    <a href="/2018/06/01/Change-the-signs-how-to-use-dynamic-programming-to-solve-a-competitive-programming-question-f9730e8f04a9/">
         Read More...
    </a>
    <hr>
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Change the signs: how to use dynamic programming to solve a competitive programming question</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Change the signs: how to use dynamic programming to solve a competitive programming question</h1>
</header>
<section data-field="subtitle" class="p-summary">
If you’re a competitive programmer like I am, one of the best feelings in the world is seeing your program getting accepted on first try on…
</section>
<section data-field="body" class="e-content">
<section name="b4c0" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3e6d" id="3e6d" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="8d9d" id="8d9d" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 78.4%;"></div><img class="graf-image" data-image-id="1*kdC2W2WKEjPIG1pRCk0qmg.png" data-width="2046" data-height="1604" data-is-featured="true" src="https://cdn-images-1.medium.com/max/2000/1*kdC2W2WKEjPIG1pRCk0qmg.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="2645" id="2645" class="graf graf--p graf-after--figure">If you’re a competitive programmer like I am, one of the best feelings in the world is seeing your program getting accepted on first try on one of the most famous programming platforms, <a href="https://www.codechef.com/" data-href="https://www.codechef.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CodeChef</a>.  <p name="86b0" id="86b0" class="graf graf--p graf-after--p">I was an avid competitive programmer during undergrad, and then lost touch with it when working as a developer @Hike. However, I recently started out into this adventurous world of programming again, all thanks to my friend <a href="https://medium.com/u/842b783318b8" data-href="https://medium.com/u/842b783318b8" data-anchor-type="2" data-user-id="842b783318b8" data-action-value="842b783318b8" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Divya Godayal</a>.-->
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Change the signs: how to use dynamic programming to solve a competitive programming question</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Change the signs: how to use dynamic programming to solve a competitive programming question</h1>
</header>
<section data-field="subtitle" class="p-summary">
If you’re a competitive programmer like I am, one of the best feelings in the world is seeing your program getting accepted on first try on…
</section>
<section data-field="body" class="e-content">
<section name="b4c0" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3e6d" id="3e6d" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="8d9d" id="8d9d" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 78.4%;"></div><img class="graf-image" data-image-id="1*kdC2W2WKEjPIG1pRCk0qmg.png" data-width="2046" data-height="1604" data-is-featured="true" src="https://cdn-images-1.medium.com/max/2000/1*kdC2W2WKEjPIG1pRCk0qmg.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="2645" id="2645" class="graf graf--p graf-after--figure">If you’re a competitive programmer like I am, one of the best feelings in the world is seeing your program getting accepted on first try on one of the most famous programming platforms, <a href="https://www.codechef.com/" data-href="https://www.codechef.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CodeChef</a>.</p><p name="86b0" id="86b0" class="graf graf--p graf-after--p">I was an avid competitive programmer during undergrad, and then lost touch with it when working as a developer @Hike. However, I recently started out into this adventurous world of programming again, all thanks to my friend <a href="https://medium.com/u/842b783318b8" data-href="https://medium.com/u/842b783318b8" data-anchor-type="2" data-user-id="842b783318b8" data-action-value="842b783318b8" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Divya Godayal</a>.</p><p name="d398" id="d398" class="graf graf--p graf-after--p">The <a href="https://www.codechef.com/MAY18" data-href="https://www.codechef.com/MAY18" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CodeChef May 2018 Long Challenge</a> ended about an hour ago, and I decided to write this article as a post describing one of the questions in the competition.</p><p name="87dc" id="87dc" class="graf graf--p graf-after--p">Without wasting any more time, let’s get to it.</p><figure name="d04c" id="d04c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 955px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 136.4%;"></div><img class="graf-image" data-image-id="1*bY14HmJRTsQME9jEE3RH6Q.png" data-width="1284" data-height="1752" src="https://cdn-images-1.medium.com/max/800/1*bY14HmJRTsQME9jEE3RH6Q.png"></div></figure><h3 name="0135" id="0135" class="graf graf--h3 graf-after--figure">Unravelling the Problem Statement</h3><p name="c48a" id="c48a" class="graf graf--p graf-after--h3">Let’s look at some examples to better understand what the problem statement is asking for.</p><p name="918d" id="918d" class="graf graf--p graf-after--p">Consider the following number sequence.</p><pre name="2089" id="2089" class="graf graf--pre graf-after--p">4 3 1 2</pre><p name="7c43" id="7c43" class="graf graf--p graf-after--pre">Now the question asks us to perform a certain operation (possibly 0 times, leaving the sequence unchanged). We can negate a certain subsequence of numbers and get a new sequence.</p><pre name="e795" id="e795" class="graf graf--pre graf-after--p">-4 3 1 2<br>4 -3 1 -2<br>4 3 -1 2<br>4 3 1 -2<br>-4 -3 1 2 etc.</pre><p name="ad56" id="ad56" class="graf graf--p graf-after--pre">The question says that the resulting sequence should satisfy the following constraint:</p><p name="3130" id="3130" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">The sum of elements of any substring with length greater than 1 is strictly positive.</strong></p><p name="d600" id="d600" class="graf graf--p graf-after--p">Clearly, the following sequences are not valid:</p><pre name="3029" id="3029" class="graf graf--pre graf-after--p">-4 3 1 2<br>4 -3 1 -2 <br>4 3 1 -2 <br>-4 -3 1 2 <br>-4 -3 -1 -2<br>4 3 -1 -2</pre><p name="b53d" id="b53d" class="graf graf--p graf-after--pre">We only have 2 valid subsequences that can be obtained by performing the operation mentioned above. <strong class="markup--strong markup--p-strong">Note:</strong> we haven’t written down all the possible subsequences. That would be 2^n, that is 16 in this case, because for every number we have two options. Either to negate it, or not.</p><p name="e93e" id="e93e" class="graf graf--p graf-after--p">So the two valid sequences are:</p><pre name="2e78" id="2e78" class="graf graf--pre graf-after--p">4 3 1 2</pre><p name="80d5" id="80d5" class="graf graf--p graf-after--pre">and</p><pre name="55db" id="55db" class="graf graf--pre graf-after--p">4 3 -1 2</pre><p name="22d4" id="22d4" class="graf graf--p graf-after--pre">The original sequence would always be one of the valid sequences as all the numbers in it are positive.</p><p name="681f" id="681f" class="graf graf--p graf-after--p">Now the question asks us to find the sequence with the minimum sum. So for the example we have considered, the sequence required would be <code class="markup--code markup--p-code">4 3 -1 2</code> .</p><h3 name="dafc" id="dafc" class="graf graf--h3 graf-after--p">Would Greedy Work?</h3><p name="12da" id="12da" class="graf graf--p graf-after--h3">A greedy approach in this question would be that if it is possible to negate a number while satisfying the given constraints, then we should negate that number. This approach however, would not always give the right results. Consider the following example.</p><pre name="4710" id="4710" class="graf graf--pre graf-after--p">4 1 3 2</pre><p name="7099" id="7099" class="graf graf--p graf-after--pre">Here, it is possible to have these three valid sets of numbers:</p><pre name="ae90" id="ae90" class="graf graf--pre graf-after--p">4 1 3 2           4 -1 3 2           4 1 3 -2</pre><p name="7b1a" id="7b1a" class="graf graf--p graf-after--pre">Clearly, both the numbers 2 and 1 can be negated. But not both of them at the same time. If we negate a number greedily — that is, if a number can be negated, then we negate it — then it is possible that we might end up negating the number 1. Then you won’t be able to negate the number 2. This would give us a suboptimal solution.</p><p name="616b" id="616b" class="graf graf--p graf-after--p">So this Greedy approach would not work here. We have to <strong class="markup--strong markup--p-strong">“try out a specific choice of whether to negate or not for a number and see what choice gives us the optimal solution”<em class="markup--em markup--p-em">.</em></strong></p><p name="1730" id="1730" class="graf graf--p graf-after--p">This smells like Dynamic Programming.</p><h3 name="175d" id="175d" class="graf graf--h3 graf-after--p">Good ol’ Dynamic Programming</h3><p name="5daa" id="5daa" class="graf graf--p graf-after--h3">One of the most interesting algorithmic techniques out there, and possibly one of the most dreaded, is dynamic programming. This is the technique we are going to use to solve this particular problem.</p><p name="9611" id="9611" class="graf graf--p graf-after--p">Two of the most important steps in any dynamic programming problem are:</p><ol class="postList"><li name="5259" id="5259" class="graf graf--li graf-after--p">Identifying the recurrent relation.</li><li name="5101" id="5101" class="graf graf--li graf-after--li">Figuring out what to <a href="https://www.interviewcake.com/concept/java/memoization" data-href="https://www.interviewcake.com/concept/java/memoization" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--li-strong">memoize</strong></a><strong class="markup--strong markup--li-strong">. (not memoRize :P)</strong></li></ol><p name="acc3" id="acc3" class="graf graf--p graf-after--li">The DP-based approach here is divided into two basic parts.</p><ul class="postList"><li name="5016" id="5016" class="graf graf--li graf-after--p">One is the main recursion that we use to find out the <strong class="markup--strong markup--li-strong">minimum sum of the final set</strong>. Note, the dynamic programming is not directly used to obtain the final set, just the sum of the final set of numbers. So our dynamic programming approach would correctly find out the sum for the example given above as 8. <code class="markup--code markup--li-code">4 + 3 + (-1) + 2 = 8</code> .</li><li name="87c5" id="87c5" class="graf graf--li graf-after--li">What we actually need is the final modified set of numbers where some (possibly none) of the numbers are negated. We use the concept of a <strong class="markup--strong markup--li-strong">parent pointer</strong> and <strong class="markup--strong markup--li-strong">backtracking</strong> to find out the actual set of numbers.</li></ul><p name="0200" id="0200" class="graf graf--p graf-after--li">Let’s move onto our recursion relation for our dynamic programming approach.</p><p name="a109" id="a109" class="graf graf--p graf-after--p">Before describing the recursive relation an important observation to make here is that if a number has been negated, <strong class="markup--strong markup--p-strong">then any adjacent number to it can not be negative</strong>. That is,<strong class="markup--strong markup--p-strong"> </strong>two adjacent numbers cannot be negative as that would give a substring of length 2 whose sum is negative, and that is not allowed according to the question.</p><p name="4f80" id="4f80" class="graf graf--p graf-after--p">For the recurrence relation, we need two variables. One is the index number of where we are in the array, and one is a boolean value that tells us if the previous number (one left to the previous number) is negated or not. So if the current index is <code class="markup--code markup--p-code">i</code>, then the boolean value would tell us if the number at <code class="markup--code markup--p-code">i — 2 </code>was negated or not. You will know the importance of this boolean variable in the next paragraph.</p><p name="481e" id="481e" class="graf graf--p graf-after--p">We need to know in <code class="markup--code markup--p-code">O(1)</code> if a number <strong class="markup--strong markup--p-strong">can</strong> be negated or not. Since we are following a recursion with memoization-based solution, whenever we are at an index <code class="markup--code markup--p-code">i </code>in the recursion, we are sure that the numbers to the right (<code class="markup--code markup--p-code">i+ 1</code> onwards) have not been processed up to this point. This means that all of them are still positive.</p><p name="0b53" id="0b53" class="graf graf--p graf-after--p">The choice of whether the number at index <code class="markup--code markup--p-code">i </code>can be negated is dependent upon the right hand side (if there is one) and the left hand side (if there is one). The right hand side is easy. All we need to check is if</p><pre name="a0cf" id="a0cf" class="graf graf--pre graf-after--p">number[i] &lt; number[i + 1]</pre><p name="2a43" id="2a43" class="graf graf--p graf-after--pre">because if this is not true, then adding these two would give a negative value for the substring <code class="markup--code markup--p-code">[i, i + 1]</code> thus making it an invalid operation.</p><p name="9678" id="9678" class="graf graf--p graf-after--p">Now comes the tricky part. We need to see if negating the number at <code class="markup--code markup--p-code">i </code>will cause a substring of negative sum to the left or not. When we reach the index <code class="markup--code markup--p-code">i </code>in our recursion, we have already processed the numbers before it, and some might have been negated as well.</p><p name="1942" id="1942" class="graf graf--p graf-after--p">So say we have this set of numbers <code class="markup--code markup--p-code">4 1 2 1</code> and we had negated the first <code class="markup--code markup--p-code">1</code> and we are now processing the last number ( <code class="markup--code markup--p-code">1</code> ).</p><pre name="94c4" id="94c4" class="graf graf--pre graf-after--p">4 -1 2 [1]</pre><p name="a361" id="a361" class="graf graf--p graf-after--pre">The last number in square brackets is the one we are processing right now. As far as the right hand side is concerned, since there is none, we can negate it. We need to check if negating this 1 at index 3 (0 based indexing) would cause any substring to the left of ≤ 0 sum. As you can see, it will produce such a substring.</p><pre name="73ed" id="73ed" class="graf graf--pre graf-after--p">-1 2 -1</pre><p name="c6d2" id="c6d2" class="graf graf--p graf-after--pre">This substring would have a 0 sum, and that is invalid according to the question. After negating a subsequence of numbers, the substrings in the final set should have a sum which is strictly positive. All the substrings of length &gt; 1.</p><p name="6932" id="6932" class="graf graf--p graf-after--p">We cannot apply the following approach here directly:</p><pre name="1698" id="1698" class="graf graf--pre graf-after--p">if number[i] &lt; number[i - 1], then it is good to go on negation.</pre><p name="0d94" id="0d94" class="graf graf--p graf-after--pre">because, although <code class="markup--code markup--p-code">1 &lt; 2</code> , if we negate that last 1 as well we will have an invalid set of numbers as seen above. So this simple approach or check won’t work here.</p><p name="e3ec" id="e3ec" class="graf graf--p graf-after--p">Here comes the boolean variable which tells us if, given an index <code class="markup--code markup--p-code">i</code>, the number at <code class="markup--code markup--p-code">i — 2 </code>was negated or not. Consider the two scenarios.</p><ul class="postList"><li name="cfc9" id="cfc9" class="graf graf--li graf-after--p">Yes, the number at index <code class="markup--code markup--li-code">i — 2</code> was negated like in the example just showcased. In that case, negation of the number at <code class="markup--code markup--li-code">i — 2</code> would have a capacity reduction for number at <code class="markup--code markup--li-code">i — 1</code>. In the example <code class="markup--code markup--li-code">4 1 2 1</code> , negating the 1 at index 1(0 based indexing) would reduce the capacity of the number 2 (at index 2) by 1. We refer to remaining values of numbers as capacities here. We need to consider this reduced capacity when performing the check to see if a number can be negated or not.</li></ul><pre name="28d5" id="28d5" class="graf graf--pre graf-after--li">number[i] &lt; reducedCapacityOfNumberAt(i - 1)</pre><ul class="postList"><li name="a228" id="a228" class="graf graf--li graf-after--pre">In case the number at index <code class="markup--code markup--li-code">i — 2</code> wasn’t negated, the number at <code class="markup--code markup--li-code">i — 1</code> is at it’s full capacity. The simple check</li></ul><pre name="267b" id="267b" class="graf graf--pre graf-after--li">number[i] &lt; number[i - 1]</pre><p name="72ce" id="72ce" class="graf graf--p graf-after--pre">would be enough to see if we can negate the number at index <code class="markup--code markup--p-code">i</code> .</p><p name="54cc" id="54cc" class="graf graf--p graf-after--p">Let’s look at the code for the recursion containing all the ideas discussed above.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="2ef6" id="2ef6" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 810px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 81%;"></div><img class="graf-image" data-image-id="1*Ng2Sul4EQstOGK91DEfFHw.png" data-width="2424" data-height="1964" src="https://cdn-images-1.medium.com/max/1000/1*Ng2Sul4EQstOGK91DEfFHw.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="944e" id="944e" class="graf graf--p graf-after--figure">That’s all nice and dandy. But, this is just recursion, and the heading says dynamic programming. That means there would be overlapping subproblems. Let us look at the recursion tree to see if there are any.</p><figure name="6d09" id="6d09" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 602px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 85.9%;"></div><img class="graf-image" data-image-id="1*LI4UwrN7wA-ep0k-mUUtpQ.png" data-width="1436" data-height="1234" src="https://cdn-images-1.medium.com/max/800/1*LI4UwrN7wA-ep0k-mUUtpQ.png"></div></figure><p name="819a" id="819a" class="graf graf--p graf-after--figure">As you can see, there are overlapping subproblems in the recursion tree. That is why we can use memoization.</p><p name="3953" id="3953" class="graf graf--p graf-after--p">The memoization is as simple as:</p><pre name="dc55" id="dc55" class="graf graf--pre graf-after--p">&quot;&quot;&quot; This comes at the top. We check if the state represented by the tuple of the index and the boolean variable is already cached &quot;&quot;&quot;</pre><pre name="ef08" id="ef08" class="graf graf--pre graf-after--pre">if(memo[i][is_prev_negated] != INF) <br>{<br>    return memo[i][is_prev_negated];<br>}<br><br></pre><pre name="4df0" id="4df0" class="graf graf--pre graf-after--pre">...... CODE<br><br></pre><pre name="67be" id="67be" class="graf graf--pre graf-after--pre"># Cache the minimum sum from this index onwards.<br>memo[i][is_prev_negated] = min(pos, neg);</pre><pre name="6dc5" id="6dc5" class="graf graf--pre graf-after--pre"># The parent pointer is used for finding out the final set of #s<br>parent[i][is_prev_negated] = min(pos, neg) == pos ? 1 : -1;</pre><p name="9afc" id="9afc" class="graf graf--p graf-after--pre">As pointed out earlier, this recursive approach would return the minimum sum of the set of numbers possible after making the valid set of modifications to them.</p><p name="ef07" id="ef07" class="graf graf--p graf-after--p">The question, however, asks us to actually print the final set of numbers that gives the minimum sum after making such modifications. For that, we need to use a parent pointer that would tell us at every index and boolean variable <code class="markup--code markup--p-code">is_prev_negated </code>’s value as to what optimal action was taken.</p><pre name="08d7" id="08d7" class="graf graf--pre graf-after--p">parent[i][is_prev_negated] = min(pos, neg) == pos ? 1 : -1;</pre><p name="6be5" id="6be5" class="graf graf--p graf-after--pre">So we simply store 1 or -1 depending upon if negating the number at index i (if possible!) gave us the minimum sum or if choosing to ignore it gave the minimum sum.</p><h3 name="bc60" id="bc60" class="graf graf--h3 graf-after--p">Backtracking</h3><p name="7a88" id="7a88" class="graf graf--p graf-after--h3">Now comes the part where we backtrack to find the solution to our original problem. Note that the decision for the very first number is what propagates the recursion further. If the first number was negated, the second number would be positive and the third number’s decision can be found using <code class="markup--code markup--p-code">parent[2][true]</code>. Similarly, if the first number wasn’t negated, then we move onto the second number and it’s decision can be found using <code class="markup--code markup--p-code">parent[1][false]</code> and so on. Let’s look at the code.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="cc4a" id="cc4a" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 739px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 73.9%;"></div><img class="graf-image" data-image-id="1*mhMeHj4y986IB_-Xce5Q2A.png" data-width="2610" data-height="1930" src="https://cdn-images-1.medium.com/max/1000/1*mhMeHj4y986IB_-Xce5Q2A.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="a053" id="a053" class="graf graf--h3 graf-after--figure">A Better Approach</h3><p name="48fa" id="48fa" class="graf graf--p graf-after--h3">If you take a look at the space complexity of the solution suggested, you will see that it’s a 2 dimensional dynamic programming solution because the state of the recursion is represented by two variables i.e. the index <code class="markup--code markup--p-code">i </code>representing what number of the array we are considering and then the boolean variable <code class="markup--code markup--p-code">is_prev_negated</code> . So the space complexity and the time complexity would be O(n*2) which is essentially O(n).</p><p name="ff62" id="ff62" class="graf graf--p graf-after--p">However, there is a slightly better approach as well to solving this problem as suggested by <a href="https://medium.com/u/842b783318b8" data-href="https://medium.com/u/842b783318b8" data-anchor-type="2" data-user-id="842b783318b8" data-action-value="842b783318b8" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Divya Godayal</a>. This problem can even be solved by 1 dimensional dynamic programming based solution.</p><p name="4e04" id="4e04" class="graf graf--p graf-after--p">Essentially, the boolean variable <code class="markup--code markup--p-code">is_prev_negated</code> is helping us to decide if we can negate a given number at index <code class="markup--code markup--p-code">i</code> or not as far as the left hand side of the array is concerned i.e. <code class="markup--code markup--p-code">all the numbers from 0 .. i-1</code> because the right hand side is anyways safe as all the numbers on that side are positive (as the recursion hasn’t reached them yet). So for the right hand side we simply checked the number at <code class="markup--code markup--p-code">i+1</code> but for the left hand side of index <code class="markup--code markup--p-code">i</code> we had to make use of the boolean variable <code class="markup--code markup--p-code">is_prev_negated</code> .</p><p name="81c6" id="81c6" class="graf graf--p graf-after--p">It turns out, that we can simply skip this boolean variable altogether and simply look ahead to decide if a number can be negated or not. Which simply means if you are at an index <code class="markup--code markup--p-code">i</code>, you check if that element along with the element at <code class="markup--code markup--p-code">i+2 </code>have the capacity to swallow the element at <code class="markup--code markup--p-code">i+1 </code>i.e.</p><pre name="405d" id="405d" class="graf graf--pre graf-after--p">numbers[i] + numbers[i+2] &gt;= numbers[i+1  (SWALLOW)</pre><p name="4c2c" id="4c2c" class="graf graf--p graf-after--pre">If there is a such a possibility, then we directly jump to <code class="markup--code markup--p-code">i+3</code>if we negate element at <code class="markup--code markup--p-code">i </code>because element at <code class="markup--code markup--p-code">i+1 </code>and <code class="markup--code markup--p-code">i+2 </code>both can’t be negative in such a scenario.</p><p name="c492" id="c492" class="graf graf--p graf-after--p">In case the swallow condition is not satisfied and we end up negating the number at index <code class="markup--code markup--p-code">i</code> , then we would jump to index <code class="markup--code markup--p-code">i+2</code> because in any case, two consecutive numbers cannot be negated. So if the number at <code class="markup--code markup--p-code">i</code> was negated, then the number at <code class="markup--code markup--p-code">i+1</code> has to be positive. The swallow check is to see if the number at <code class="markup--code markup--p-code">i+2</code> would definitely have to be positive or if we can exercise the choice of whether to negate or not there.</p><p name="f51e" id="f51e" class="graf graf--p graf-after--p">Have a look at the code for a better understanding.</p></div><div class="section-inner sectionLayout--outsetColumn"><figure name="a0a8" id="a0a8" class="graf graf--figure graf--layoutOutsetCenter graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1000px; max-height: 734px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 73.4%;"></div><img class="graf-image" data-image-id="1*d3XdH8Qi2dwLsRX5G9E3sQ.png" data-width="2296" data-height="1686" src="https://cdn-images-1.medium.com/max/1000/1*d3XdH8Qi2dwLsRX5G9E3sQ.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="13fd" id="13fd" class="graf graf--p graf-after--figure">Hence, just a single variable i.e. the index is used to define the state of the recursion. So the time and space complexity, both got reduced to half of what they were in the previous solution.</p><p name="e47c" id="e47c" class="graf graf--p graf-after--p graf--trailing">I hope you were able to grasp the working of the algorithm described above and how the dynamic programming technique fits into this problem. I think it’s an interesting problem, because you not only have to use dynamic programming but also the concept of parent pointer to retrace the steps through the optimal solution and get the answer required in the question.</p></div></div></section>
</section>
</article></body></html>-->
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2018/05/15/I-need-a-haircut-d0d72d674fdb/">
        I need a haircut
      </a>
    </h1>

    <span class="post-date">15 May 2018</span>
  
    
    <!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>I need a haircut</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">I need a haircut</h1>
</header>
<section data-field="subtitle" class="p-summary">
“Should I get a haircut?”
</section>
<section data-field="body" class="e-content">
<section name="4975" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="dc83" id="dc83" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="8777" id="8777" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 83.8%;"></div><img class="graf-image" data-image-id="1*mwN4UShcmng7WJY5LjlzIQ.png" data-width="1500" data-height="1257" src="https://cdn-images-1.medium.com/max/2000/1*mwN4UShcmng7WJY5LjlzIQ.png"></div><figcaption class="imageCaption">Source: <a href="http://www.lentilla.info/" data-href="http://www.lentilla.info/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">http://www.lentilla.info/</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="ca91" id="ca91" class="graf graf--p graf--startsWithDoubleQuote graf-after--figure">“Should I get a haircut?”
    <br>
    <a href="/2018/05/15/I-need-a-haircut-d0d72d674fdb/">
         Read More...
    </a>
    <hr>
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>I need a haircut</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">I need a haircut</h1>
</header>
<section data-field="subtitle" class="p-summary">
“Should I get a haircut?”
</section>
<section data-field="body" class="e-content">
<section name="4975" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="dc83" id="dc83" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="8777" id="8777" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 83.8%;"></div><img class="graf-image" data-image-id="1*mwN4UShcmng7WJY5LjlzIQ.png" data-width="1500" data-height="1257" src="https://cdn-images-1.medium.com/max/2000/1*mwN4UShcmng7WJY5LjlzIQ.png"></div><figcaption class="imageCaption">Source: <a href="http://www.lentilla.info/" data-href="http://www.lentilla.info/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">http://www.lentilla.info/</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="ca91" id="ca91" class="graf graf--p graf--startsWithDoubleQuote graf-after--figure">“Should I get a haircut?”  <p name="9eab" id="9eab" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“I think it’s been difficult to manage them lately and its too hot outside. I think I should get a haircut done.”-->
    <!--<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>I need a haircut</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 100%;
        margin: auto;
      }
      section {
        width: 100%;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 100%;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">I need a haircut</h1>
</header>
<section data-field="subtitle" class="p-summary">
“Should I get a haircut?”
</section>
<section data-field="body" class="e-content">
<section name="4975" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="dc83" id="dc83" class="graf graf--h3 graf--leading graf--title"></h3></div><div class="section-inner sectionLayout--fullWidth"><figure name="8777" id="8777" class="graf graf--figure graf--layoutFillWidth graf-after--h3"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 83.8%;"></div><img class="graf-image" data-image-id="1*mwN4UShcmng7WJY5LjlzIQ.png" data-width="1500" data-height="1257" src="https://cdn-images-1.medium.com/max/2000/1*mwN4UShcmng7WJY5LjlzIQ.png"></div><figcaption class="imageCaption">Source: <a href="http://www.lentilla.info/" data-href="http://www.lentilla.info/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">http://www.lentilla.info/</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="ca91" id="ca91" class="graf graf--p graf--startsWithDoubleQuote graf-after--figure">“Should I get a haircut?”</p><p name="9eab" id="9eab" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“I think it’s been difficult to manage them lately and its too hot outside. I think I should get a haircut done.”</p><p name="8ea0" id="8ea0" class="graf graf--p graf--startsWithDoubleQuote graf-after--p graf--trailing">“Let me go to the nearby XYZ saloon and get this over with.”</p></div></div></section><section name="3e35" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="82c1" id="82c1" class="graf graf--h3 graf--leading">The Walk</h3><p name="310b" id="310b" class="graf graf--p graf-after--h3">As I approach the salon, 1000 questions flood my head.</p><p name="b83b" id="b83b" class="graf graf--p graf-after--p">What if they cut my hair too short ?</p><p name="89aa" id="89aa" class="graf graf--p graf-after--p">What if they aren’t equal at the end of it ?</p><p name="34a9" id="34a9" class="graf graf--p graf-after--p">What if they use some weird oil on my head ?</p><p name="a0ed" id="a0ed" class="graf graf--p graf-after--p">Will they clean the razor before using it on my skin ?</p><p name="a12e" id="a12e" class="graf graf--p graf-after--p">Will they wash my hair afterwards ?</p><p name="43bc" id="43bc" class="graf graf--p graf-after--p">Will they understand exactly how I want my haircut to be ?</p><p name="b8ea" id="b8ea" class="graf graf--p graf-after--p graf--trailing">What if an inexperienced guy mistakenly cuts my skin ?</p></div></div></section><section name="9977" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3c3e" id="3c3e" class="graf graf--h3 graf--leading">The Wait</h3><p name="9125" id="9125" class="graf graf--p graf-after--h3">As usual, there’s a huge line in waiting. Ahhh, the dreaded wait.</p><figure name="cb89" id="cb89" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 460px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.8%;"></div><img class="graf-image" data-image-id="1*gLuaR7gOL3Rh53LaFllpbQ.jpeg" data-width="800" data-height="526" src="https://cdn-images-1.medium.com/max/800/1*gLuaR7gOL3Rh53LaFllpbQ.jpeg"></div><figcaption class="imageCaption">Source: <a href="https://www.westernseminary.edu/transformedblog" data-href="https://www.westernseminary.edu/transformedblog" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.westernseminary.edu/transformedblog</a></figcaption></figure><p name="1438" id="1438" class="graf graf--p graf-after--figure">As I wait patiently for my turn to come, I constantly think about whom I want to cut my hair.</p><p name="7fe0" id="7fe0" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Hmmmm, he looks experienced?”</p><p name="2151" id="2151" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Oh no! he’s just not focussed”</p><p name="3729" id="3729" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“His work looks messy”</p><p name="bb2f" id="bb2f" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Too much talking. Nah!”</p><p name="b02b" id="b02b" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“I think this is the perfect one. He’s listening to the customer and is taking his time”</p><p name="1e4f" id="1e4f" class="graf graf--p graf-after--p graf--trailing">But I almost never get the one I want. Never!</p></div></div></section><section name="edfe" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="45b6" id="45b6" class="graf graf--h3 graf--leading">And, its my turn</h3><p name="5197" id="5197" class="graf graf--p graf-after--h3">And finally, they call out “Next!” and I know its my turn.</p><p name="3e01" id="3e01" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Oh No. This is exactly the person I didn’t want me to work on my precious hair. He’ll surely spoil it.”</p><p name="5ddb" id="5ddb" class="graf graf--p graf-after--p">I’m seated on the hot seat and the million dollar question comes up.</p><p name="9477" id="9477" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Sir, How would you like your hair cut?”</p><p name="932f" id="932f" class="graf graf--p graf-after--p">And my reply which has been the same for over a decade now is</p><blockquote name="2607" id="2607" class="graf graf--pullquote graf--startsWithDoubleQuote graf-after--p">“Don’t cut them too short, I want the length to be equal on all sides. Nothing fancy”</blockquote><p name="38d8" id="38d8" class="graf graf--p graf-after--pullquote">Somehow, nobody seems to grasp this perfectly. What they instead hear is</p><blockquote name="9b12" id="9b12" class="graf graf--pullquote graf--startsWithDoubleQuote graf-after--p">“Medium haircut”</blockquote><figure name="d75c" id="d75c" class="graf graf--figure graf-after--pullquote"><div class="aspectRatioPlaceholder is-locked" style="max-width: 673px; max-height: 494px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 73.4%;"></div><img class="graf-image" data-image-id="1*sorVzz97vPMzyQ0G2o6CXQ.jpeg" data-width="673" data-height="494" src="https://cdn-images-1.medium.com/max/800/1*sorVzz97vPMzyQ0G2o6CXQ.jpeg"></div></figure><p name="fe74" id="fe74" class="graf graf--p graf-after--figure">Why do they forget the part where they had to keep all my hair equal ?</p><h3 name="4a56" id="4a56" class="graf graf--h3 graf-after--p">Trimmer or Scissors</h3><p name="8eb2" id="8eb2" class="graf graf--p graf-after--h3">Now, the next scariest thing when the barber starts off is whether they will use the good old scissors or the dreaded trimmer.</p><p name="03a2" id="03a2" class="graf graf--p graf-after--p">The trimmer does the job very quickly, but sometimes too quickly. And the scissors, well, it does take time but they’re the best if you ask me.</p><p name="38a6" id="38a6" class="graf graf--p graf-after--p">As usual, the barber decides to use a trimmer. :((</p><p name="1a1a" id="1a1a" class="graf graf--p graf-after--p">Now this is the moment where my heart starts pounding.</p><p name="332f" id="332f" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“The trimmer is coming close.”</p><p name="937c" id="937c" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“What if he makes a deep cut. There’s no going back.”</p><p name="453b" id="453b" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Buckle up Sachin! This is it.”</p><figure name="2fc9" id="2fc9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 467px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><img class="graf-image" data-image-id="1*LKFUJK6UnXCgzFIPBui-sA.jpeg" data-width="900" data-height="600" src="https://cdn-images-1.medium.com/max/800/1*LKFUJK6UnXCgzFIPBui-sA.jpeg"></div><figcaption class="imageCaption">Source: <a href="https://smartblogger.com/fear-openings/" data-href="https://smartblogger.com/fear-openings/" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://smartblogger.com/fear-openings/</a></figcaption></figure><p name="21a0" id="21a0" class="graf graf--p graf-after--figure">The barber brings a small trimmer towards me. But, what I see is this.</p><figure name="9d72" id="9d72" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 467px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><img class="graf-image" data-image-id="1*AG85XPYa6cx4GrLt0QIydw.jpeg" data-width="768" data-height="512" src="https://cdn-images-1.medium.com/max/800/1*AG85XPYa6cx4GrLt0QIydw.jpeg"></div><figcaption class="imageCaption">Source: <a href="https://www.thoughtco.com/using-regular-motor-oil-chainsaw-bar-1342724" data-href="https://www.thoughtco.com/using-regular-motor-oil-chainsaw-bar-1342724" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.thoughtco.com/using-regular-motor-oil-chainsaw-bar-1342724</a></figcaption></figure><p name="ccce" id="ccce" class="graf graf--p graf-after--figure">Aaaaaaaaand. Zap!</p><p name="46f2" id="46f2" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“Oh GOD, did he cut it too short?”</p><p name="4845" id="4845" class="graf graf--p graf-after--p">Sometimes, its a yes and I feel as if I’m scarred for life.</p><p name="625b" id="625b" class="graf graf--p graf-after--p">Sometimes, its a no and I’m like “Phew!” . But the haircut session is not over yet. Things can still go bad.</p><p name="9a45" id="9a45" class="graf graf--p graf-after--p">After about 10 minutes of using the trimmer to butcher my hair, the barber decides to finally use a scissor and I feel a sigh of relief.</p><figure name="76ed" id="76ed" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 600px; max-height: 770px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 128.29999999999998%;"></div><img class="graf-image" data-image-id="1*wQATo9jQqe0iBm8WSYZTnA.jpeg" data-width="600" data-height="770" src="https://cdn-images-1.medium.com/max/800/1*wQATo9jQqe0iBm8WSYZTnA.jpeg"></div><figcaption class="imageCaption">Source: <a href="https://makeameme.org/meme/phew-thank-goodness" data-href="https://makeameme.org/meme/phew-thank-goodness" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://makeameme.org/meme/phew-thank-goodness</a></figcaption></figure><p name="0bd0" id="0bd0" class="graf graf--p graf-after--figure">The most peaceful time during the entire session is when the barber uses the scissors. I feel at peace. At least there won’t be anything sudden and they would cut my hair carefully.</p><p name="b6f2" id="b6f2" class="graf graf--p graf-after--p">It’s not like with trimmers. One mistake. One shake up. And a patch of my hair is gone. :/ :/</p><p name="2de7" id="2de7" class="graf graf--p graf-after--p">And then there’s no going back.</p><p name="37b1" id="37b1" class="graf graf--p graf-after--p">Anyways. Over the years I’ve learnt to tell the barber I want my hair cut to be medium which is not usually what I want. The reason is that if they cut it too short initially and not not according to what I want the hair can’t grow back instantly right ?</p><p name="135e" id="135e" class="graf graf--p graf-after--p graf--trailing">So I tell them to cut it medium initially and I tell them to shorten it again after they ask me if the hair cut looks good. 😛😛</p></div></div></section><section name="45b0" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="78e2" id="78e2" class="graf graf--h3 graf--leading">It’s done</h3><p name="8aea" id="8aea" class="graf graf--p graf-after--h3">Finally, the hair cut is done. And I feel like its a disaster. As usual.</p><p name="ff1b" id="ff1b" class="graf graf--p graf-after--p">I am never happy with the hair cut. I have to put up a fake smile though.</p><figure name="5b5b" id="5b5b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 582px; max-height: 508px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 87.3%;"></div><img class="graf-image" data-image-id="1*VoQmfa53diec86o8sB9Mjw.png" data-width="582" data-height="508" src="https://cdn-images-1.medium.com/max/800/1*VoQmfa53diec86o8sB9Mjw.png"></div><figcaption class="imageCaption">Source: <a href="https://www.pinterest.com/pin/748301294306046836/?lp=true" data-href="https://www.pinterest.com/pin/748301294306046836/?lp=true" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.pinterest.com/pin/748301294306046836/?lp=true</a></figcaption></figure><p name="2ab8" id="2ab8" class="graf graf--p graf-after--figure">I pay the barber and I’m on my way back thinking about what I can change the next time I come in for a haircut.</p><p name="02eb" id="02eb" class="graf graf--p graf-after--p">This is me walking out of the barber shop.</p><figure name="6255" id="6255" class="graf graf--figure graf-after--p graf--trailing"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 432px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 61.7%;"></div><img class="graf-image" data-image-id="1*JRy-c6ItxbpdCjnqe17VMg.jpeg" data-width="810" data-height="500" src="https://cdn-images-1.medium.com/max/800/1*JRy-c6ItxbpdCjnqe17VMg.jpeg"></div><figcaption class="imageCaption">Source: <a href="https://www.lifesitenews.com/blogs/as-absurd-as-it-sounds-this-is-how-we-picked-up-our-abortionist-on-abortion" data-href="https://www.lifesitenews.com/blogs/as-absurd-as-it-sounds-this-is-how-we-picked-up-our-abortionist-on-abortion" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://www.lifesitenews.com/blogs/as-absurd-as-it-sounds-this-is-how-we-picked-up-our-abortionist-on-abortion</a></figcaption></figure></div></div></section>
</section>
</article></body></html>-->
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

    </div>

  </body>
</html>
